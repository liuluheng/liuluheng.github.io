<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Shell Scrap</title>
<!-- 2015-03-07 Sat 15:38 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Shi Shougang" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link href="../assets/bootstrap.min.css" rel="stylesheet" media="screen">
<link href="../assets/bootstrap-responsive.min.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="../assets/stylesheet.css" />
<script src="assets/js/bootstrap.min.js"></script>

<script type="text/javascript" src="assets/js/org-info.js">
/**
 *
 * @source: assets/js/org-info.js
 *
 * @licstart  The following is the entire license notice for the
 *  JavaScript code in assets/js/org-info.js.
 *
 * Copyright (C) 2012-2013 Free Software Foundation, Inc.
 *
 *
 * The JavaScript code in this tag is free software: you can
 * redistribute it and/or modify it under the terms of the GNU
 * General Public License (GNU GPL) as published by the Free Software
 * Foundation, either version 3 of the License, or (at your option)
 * any later version.  The code is distributed WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.
 *
 * As additional permission under GNU GPL version 3 section 7, you
 * may distribute non-source (e.g., minimized or compacted) forms of
 * that code without the copy of the GNU GPL normally required by
 * section 4, provided you include this license notice and a URL
 * through which recipients can access the Corresponding Source.
 *
 * @licend  The above is the entire license notice
 * for the JavaScript code in assets/js/org-info.js.
 *
 */
</script>

<script type="text/javascript">

/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/

<!--/*--><![CDATA[/*><!--*/
org_html_manager.set("TOC_DEPTH", "2");
org_html_manager.set("LINK_HOME", "");
org_html_manager.set("LINK_UP", "");
org_html_manager.set("LOCAL_TOC", "0");
org_html_manager.set("VIEW_BUTTONS", "0");
org_html_manager.set("MOUSE_HINT", "#dddddd");
org_html_manager.set("FIXED_TOC", "0");
org_html_manager.set("TOC", "0");
org_html_manager.set("VIEW", "showall");
org_html_manager.setup();  // activate after the parameters are set
/*]]>*///-->
</script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/javascript" src="http://orgmode.org/mathjax/MathJax.js"></script>
<script type="text/javascript">
<!--/*--><![CDATA[/*><!--*/
    MathJax.Hub.Config({
        // Only one of the two following lines, depending on user settings
        // First allows browser-native MathML display, second forces HTML/CSS
        //  config: ["MMLorHTML.js"], jax: ["input/TeX"],
            jax: ["input/TeX", "output/HTML-CSS"],
        extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js",
                     "TeX/noUndefined.js"],
        tex2jax: {
            inlineMath: [ ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"], ["\\begin{displaymath}","\\end{displaymath}"] ],
            skipTags: ["script","noscript","style","textarea","pre","code"],
            ignoreClass: "tex2jax_ignore",
            processEscapes: false,
            processEnvironments: true,
            preview: "TeX"
        },
        showProcessingMessages: true,
        displayAlign: "center",
        displayIndent: "2em",

        "HTML-CSS": {
             scale: 100,
             availableFonts: ["STIX","TeX"],
             preferredFont: "TeX",
             webFont: "TeX",
             imageFont: "TeX",
             showMathMenu: true,
        },
        MMLorHTML: {
             prefer: {
                 MSIE:    "MML",
                 Firefox: "MML",
                 Opera:   "HTML",
                 other:   "HTML"
             }
        }
    });
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Shell Scrap</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">Flow Control</a>
<ul>
<li><a href="#sec-1-1">if</a></li>
<li><a href="#sec-1-2">case</a></li>
<li><a href="#sec-1-3">Loops</a></li>
</ul>
</li>
<li><a href="#sec-2">Keyboard Input</a>
<ul>
<li><a href="#sec-2-1">read</a></li>
</ul>
</li>
<li><a href="#sec-3">Parameters</a>
<ul>
<li><a href="#sec-3-1"><code>$#</code></a></li>
<li><a href="#sec-3-2"><code>shift</code></a></li>
</ul>
</li>
<li><a href="#sec-4">Errors and Signals and Traps</a>
<ul>
<li><a href="#sec-4-1">Exit status</a></li>
</ul>
</li>
<li><a href="#sec-5">Creating safe temporary files</a>
<ul>
<li><a href="#sec-5-1">example</a></li>
</ul>
</li>
<li><a href="#sec-6">Debug</a>
<ul>
<li><a href="#sec-6-1">Watching your script run</a></li>
<li><a href="#sec-6-2">trap command</a></li>
<li><a href="#sec-6-3">tee command</a></li>
<li><a href="#sec-6-4">use debug hook</a></li>
<li><a href="#sec-6-5">command</a></li>
</ul>
</li>
<li><a href="#sec-7">Parameter expansion</a>
<ul>
<li><a href="#sec-7-1">Simple usage</a></li>
<li><a href="#sec-7-2">Indirection</a></li>
<li><a href="#sec-7-3">Case modification</a></li>
<li><a href="#sec-7-4">Variable name expansion</a></li>
<li><a href="#sec-7-5">Substring removal</a></li>
<li><a href="#sec-7-6">Search and replace</a></li>
<li><a href="#sec-7-7">String length</a></li>
<li><a href="#sec-7-8">Substring expansion</a></li>
<li><a href="#sec-7-9">Use a default value</a></li>
<li><a href="#sec-7-10">Assign a default value</a></li>
<li><a href="#sec-7-11">Use an alternate value</a></li>
<li><a href="#sec-7-12">Display error if null or unset</a></li>
<li><a href="#sec-7-13">Arithmetic and command expansion</a></li>
<li><a href="#sec-7-14">Brace expansion</a></li>
<li><a href="#sec-7-15">aa</a></li>
</ul>
</li>
<li><a href="#sec-8">String Operators</a></li>
<li><a href="#sec-9">Command</a></li>
<li><a href="#sec-10">getopts</a></li>
<li><a href="#sec-11">compute float number</a></li>
<li><a href="#sec-12">positional parameters</a>
<ul>
<li><a href="#sec-12-1">loop through the positional parameters</a></li>
<li><a href="#sec-12-2">mass usage</a></li>
<li><a href="#sec-12-3">Range Of Positional Parameters</a></li>
</ul>
</li>
<li><a href="#sec-13">多个文件总大小</a></li>
<li><a href="#sec-14">regular expression</a></li>
<li><a href="#sec-15">touch</a>
<ul>
<li><a href="#sec-15-1">touch all folders in a directory</a></li>
<li><a href="#sec-15-2">touch all files in a directory</a></li>
</ul>
</li>
</ul>
</div>
</div>


<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Flow Control</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1">if</h3>
<div class="outline-text-3" id="text-1-1">
</div><ul class="org-ul"><li><a id="sec-1-1-1" name="sec-1-1-1"></a>syntax<br  /><div class="outline-text-4" id="text-1-1-1">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #ff7f24;"># </span><span style="color: #ff7f24;">First form</span>

<span style="color: #00ffff;">if</span> condition ; <span style="color: #00ffff;">then</span>
    commands
<span style="color: #00ffff;">fi</span>

<span style="color: #ff7f24;"># </span><span style="color: #ff7f24;">Second form</span>

<span style="color: #00ffff;">if</span> condition ; <span style="color: #00ffff;">then</span>
    commands
<span style="color: #00ffff;">else</span>
    commands
<span style="color: #00ffff;">fi</span>

<span style="color: #ff7f24;"># </span><span style="color: #ff7f24;">Third form</span>

<span style="color: #00ffff;">if</span> condition ; <span style="color: #00ffff;">then</span>
    commands
<span style="color: #00ffff;">elif</span> condition ; <span style="color: #00ffff;">then</span>
    commands
<span style="color: #00ffff;">fi</span>
</pre>
</div>
</div>
</li>

<li><a id="sec-1-1-2" name="sec-1-1-2"></a>Example<br  /><div class="outline-text-4" id="text-1-1-2">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #00ffff;">if</span> [ -f .bash_profile ]; <span style="color: #00ffff;">then</span>
    <span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"You have a .bash_profile. Things are fine."</span>
<span style="color: #00ffff;">else</span>
    <span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"Yikes! You have no .bash_profile!"</span>
<span style="color: #00ffff;">fi</span>
</pre>
</div>
</div>
</li>

<li><a id="sec-1-1-3" name="sec-1-1-3"></a>Condition<br  /><div class="outline-text-4" id="text-1-1-3">
<p>
Expression    Description
</p>

<ul class="org-ul">
<li>-d file True if file is a directory.
</li>
<li>-e file True if file exists.
</li>
<li>-f file True if file exists and is a regular file.
</li>
<li>-L file True if file is a symbolic link.
</li>
<li>-r file True if file is a file readable by you.
</li>
<li>-w file True if file is a file writable by you.
</li>
<li>-x file True if file is a file executable by you.
</li>
<li>file1 -nt file2  True if file1 is newer than (according to modification time) file2
</li>
<li>file1 -ot file2  True if file1 is older than file2
</li>
<li>-z string True if string is empty.
</li>
<li>-n string  True if string is not empty.
</li>
<li>string1 = string2  True if string1 equals string2.
</li>
<li>string1 != string2  True if string1 does not equal string2.
</li>
<li>-a (AND) and -o (OR). The -a and -o operators are similar to the &amp;&amp;
and || operators used with exit statuses. 
</li>
</ul>
</div>
</li></ul>
</div>

<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2">case</h3>
<div class="outline-text-3" id="text-1-2">
</div><ul class="org-ul"><li><a id="sec-1-2-1" name="sec-1-2-1"></a>syntax<br  /><div class="outline-text-4" id="text-1-2-1">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #00ffff;">case</span> word<span style="color: #00ffff;"> in</span>
    patterns ) statements ;;
<span style="color: #00ffff;">esac</span>
</pre>
</div>
</div>
</li>

<li><a id="sec-1-2-2" name="sec-1-2-2"></a>example<br  /><div class="outline-text-4" id="text-1-2-2">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #ff7f24;">#</span><span style="color: #ff7f24;">!/bin/</span><span style="color: #00ffff;">bash</span>

<span style="color: #b0c4de;">echo</span> -n <span style="color: #ffa07a;">"Enter a number between 1 and 3 inclusive &gt; "</span>
<span style="color: #b0c4de;">read</span> character
<span style="color: #00ffff;">case</span> $<span style="color: #eedd82;">character</span><span style="color: #00ffff;"> in</span>
    1 ) <span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"You entered one."</span>
        ;;
    2 ) <span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"You entered two."</span>
        ;;
    3 ) <span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"You entered three."</span>
        ;;
    * ) <span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"You did not enter a number"</span>
        <span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"between 1 and 3."</span>
<span style="color: #00ffff;">esac</span>
</pre>
</div>
</div>
</li></ul>
</div>

<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3">Loops</h3>
<div class="outline-text-3" id="text-1-3">
</div><ul class="org-ul"><li><a id="sec-1-3-1" name="sec-1-3-1"></a>while<br  /><ul class="org-ul"><li><a id="sec-1-3-1-1" name="sec-1-3-1-1"></a>example<br  /><div class="outline-text-5" id="text-1-3-1-1">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #ff7f24;">#</span><span style="color: #ff7f24;">!/bin/</span><span style="color: #00ffff;">bash</span>

<span style="color: #eedd82;">number</span>=0
<span style="color: #00ffff;">while</span> [ $<span style="color: #eedd82;">number</span> -lt 10 ]; <span style="color: #00ffff;">do</span>
    <span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"Number = $number"</span>
    <span style="color: #eedd82;">number</span>=$((number + 1))
<span style="color: #00ffff;">done</span>
</pre>
</div>
</div>
</li></ul>
</li>
<li><a id="sec-1-3-2" name="sec-1-3-2"></a>until<br  /><div class="outline-text-4" id="text-1-3-2">
<p>
The until command works exactly the same way, except the block of code
is repeated as long as the condition is false.
</p>
</div>

<ul class="org-ul"><li><a id="sec-1-3-2-1" name="sec-1-3-2-1"></a>Example<br  /><div class="outline-text-5" id="text-1-3-2-1">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #ff7f24;">#</span><span style="color: #ff7f24;">!/bin/</span><span style="color: #00ffff;">bash</span>

<span style="color: #eedd82;">number</span>=0
<span style="color: #00ffff;">until</span> [ $<span style="color: #eedd82;">number</span> -ge 10 ]; <span style="color: #00ffff;">do</span>
    <span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"Number = $number"</span>
    <span style="color: #eedd82;">number</span>=$((number + 1))
<span style="color: #00ffff;">done</span>
</pre>
</div>
</div>
</li></ul>
</li>

<li><a id="sec-1-3-3" name="sec-1-3-3"></a><code>for</code><br  /><ul class="org-ul"><li><a id="sec-1-3-3-1" name="sec-1-3-3-1"></a>syntax<br  /><div class="outline-text-5" id="text-1-3-3-1">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #00ffff;">for</span> variable<span style="color: #00ffff;"> in</span> words; <span style="color: #00ffff;">do</span>
    statements
<span style="color: #00ffff;">done</span>
</pre>
</div>
</div>
</li></ul>
</li></ul>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Keyboard Input</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">read</h3>
<div class="outline-text-3" id="text-2-1">
</div><ul class="org-ul"><li><a id="sec-2-1-1" name="sec-2-1-1"></a>example<br  /><div class="outline-text-4" id="text-2-1-1">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #ff7f24;">#</span><span style="color: #ff7f24;">!/bin/</span><span style="color: #00ffff;">bash</span><span style="color: #ff7f24;"> </span>

<span style="color: #b0c4de;">echo</span> -n <span style="color: #ffa07a;">"Enter some text &gt; "</span>
<span style="color: #b0c4de;">read</span> text
<span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"You entered: $text"</span>
</pre>
</div>
</div>
</li>
<li><a id="sec-2-1-2" name="sec-2-1-2"></a>option <code>-t</code> (time)<br  /><div class="outline-text-4" id="text-2-1-2">
<p>
The -t option followed by a number of seconds provides an automatic
timeout for the read command. 
</p>
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #ff7f24;">#</span><span style="color: #ff7f24;">!/bin/</span><span style="color: #00ffff;">bash</span>
<span style="color: #b0c4de;">echo</span> -n <span style="color: #ffa07a;">"Hurry up and type something! &gt; "</span>
<span style="color: #00ffff;">if </span><span style="color: #b0c4de;">read</span> -t 3 response; <span style="color: #00ffff;">then</span>
    <span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"Great, you made it in time!"</span>
<span style="color: #00ffff;">else</span>
    <span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"Sorry, you are too slow!"</span>
<span style="color: #00ffff;">fi</span>
</pre>
</div>
</div>
</li>

<li><a id="sec-2-1-3" name="sec-2-1-3"></a>option <code>-s</code><br  /><div class="outline-text-4" id="text-2-1-3">
<p>
The -s option causes the user's typing not to be displayed. 
</p>
</div>
</li></ul>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">Parameters</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1"><code>$#</code></h3>
<div class="outline-text-3" id="text-3-1">
<p>
the shell maintains a variable called $# that contains the number of
items on the command line
</p>
</div>
</div>
<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2"><code>shift</code></h3>
<div class="outline-text-3" id="text-3-2">
<p>
<code>shift</code> is a shell builtin that operates on the positional parameters.
Each time you invoke shift, it "shifts" all the positional parameters
down by one. $2 becomes $1, $3 becomes $2, $4 becomes $3, and so on.
</p>
</div>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">Errors and Signals and Traps</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1">Exit status</h3>
<div class="outline-text-3" id="text-4-1">
</div><ul class="org-ul"><li><a id="sec-4-1-1" name="sec-4-1-1"></a>Checking the exit status<br  /><div class="outline-text-4" id="text-4-1-1">
<p>
First, you can examine the contents of the $? environment variable. $?
will contain the exit status of the last command executed.
</p>

<div class="org-src-container">

<pre class="src src-sh">[me] $ true; <span style="color: #b0c4de;">echo</span> $<span style="color: #eedd82;">?</span>
0
[me] $ false; <span style="color: #b0c4de;">echo</span> $<span style="color: #eedd82;">?</span>
1
</pre>
</div>
</div>
</li></ul>
</div>
</div>
<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">Creating safe temporary files</h2>
<div class="outline-text-2" id="text-5">
<p>
The preferred technique is to write them in a local directory such as
<code>~/tmp</code> (a tmp subdirectory in the user's home directory.) If you must
write files in <code>/tmp</code>, you must take steps to make sure the file names
are not predictable. Predictable file names allow an attacker to
create symbolic links to other files that the attacker wants you to
overwrite.
</p>
</div>
<div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1">example</h3>
<div class="outline-text-3" id="text-5-1">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #eedd82;">TEMP_FILE</span>=$<span style="color: #eedd82;">TEMP_DIR</span>/printfile.$<span style="color: #eedd82;">$</span>.$<span style="color: #eedd82;">RANDOM</span>
</pre>
</div>
<ul class="org-ul">
<li><code>$$</code> shell variable to embed the process id (pid) of the program
</li>
<li><code>$RANDOM</code> shell variable to append a random number to the file name
</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6">Debug</h2>
<div class="outline-text-2" id="text-6">
</div><div id="outline-container-sec-6-1" class="outline-3">
<h3 id="sec-6-1">Watching your script run</h3>
<div class="outline-text-3" id="text-6-1">
</div><ul class="org-ul"><li><a id="sec-6-1-1" name="sec-6-1-1"></a>Method1<br  /><div class="outline-text-4" id="text-6-1-1">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #ff7f24;">#</span><span style="color: #ff7f24;">!/bin/</span><span style="color: #00ffff;">bash</span><span style="color: #ff7f24;"> -x</span>
</pre>
</div>
</div>
</li>
<li><a id="sec-6-1-2" name="sec-6-1-2"></a>Method2<br  /><div class="outline-text-4" id="text-6-1-2">
<p>
you can use the set command within your script to turn tracing on and
off. Use <code>set -x</code> to turn tracing on and <code>set +x</code> to turn tracing off. For
example.:
</p>

<div class="org-src-container">

<pre class="src src-sh"><span style="color: #ff7f24;">#</span><span style="color: #ff7f24;">!/bin/</span><span style="color: #00ffff;">bash</span>

<span style="color: #eedd82;">number</span>=1

<span style="color: #b0c4de;">set</span> -x
<span style="color: #00ffff;">if</span> [ $<span style="color: #eedd82;">number</span> = <span style="color: #ffa07a;">"1"</span> ]; <span style="color: #00ffff;">then</span>
    <span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"Number equals 1"</span>
<span style="color: #00ffff;">else</span>
    <span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"Number does not equal 1"</span>
<span style="color: #00ffff;">fi</span>
<span style="color: #b0c4de;">set</span> +x
</pre>
</div>
</div>
</li></ul>
</div>
<div id="outline-container-sec-6-2" class="outline-3">
<h3 id="sec-6-2">trap command</h3>
<div class="outline-text-3" id="text-6-2">
<p>
其基本的语法是:
</p>
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #00ffff;">trap</span> <span style="color: #ffa07a;">'command'</span> signal
</pre>
</div>
<p>
其中signal是要捕获的信号，command是捕获到指定的信号之后，所要执行的命令。可以用kill –l命令看到系统中全部可用的信号名，捕获信号后所执行的命令可以是任何一条或多条合法的shell语句，也可以是一个函数名。
</p>

<p>
shell脚本在执行时，会产生三个所谓的“伪信号”，(之所以称之为“伪信号”是因为这三个信号是由shell产生的，而其它的信号是由操作系统产生的)，通过使用trap命令捕获这三个“伪信号”并输出相关信息对调试非常有帮助。
</p>

<div class="org-src-container">

<pre class="src src-sh">EXIT  &#20174;&#19968;&#20010;&#20989;&#25968;&#20013;&#36864;&#20986;&#25110;&#25972;&#20010;&#33050;&#26412;&#25191;&#34892;&#23436;&#27605; 
ERR   &#24403;&#19968;&#26465;&#21629;&#20196;&#36820;&#22238;&#38750;&#38646;&#29366;&#24577;&#26102;(&#20195;&#34920;&#21629;&#20196;&#25191;&#34892;&#19981;&#25104;&#21151;) 
DEBUG &#33050;&#26412;&#20013;&#27599;&#19968;&#26465;&#21629;&#20196;&#25191;&#34892;&#20043;&#21069;
</pre>
</div>
</div>
<ul class="org-ul"><li><a id="sec-6-2-1" name="sec-6-2-1"></a>example<br  /><div class="outline-text-4" id="text-6-2-1">
<ul class="org-ul">
<li>ERR
</li>
</ul>
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #87cefa;">ERRTRAP</span>()
     {
       <span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"[LINE:$1] Error: Command or function exited with status $?"</span>
     }
     foo()
     {
       <span style="color: #00ffff;">return</span> 1;
     }
     <span style="color: #00ffff;">trap</span> <span style="color: #ffa07a;">'ERRTRAP $LINENO'</span> ERR
    abc
    foo
</pre>
</div>
<ul class="org-ul">
<li>DEBUG
</li>
</ul>
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #ff7f24;">#</span><span style="color: #ff7f24;">!/bin/</span><span style="color: #00ffff;">bash</span>
<span style="color: #00ffff;">trap</span> <span style="color: #ffa07a;">'echo &#8220;before execute line:$LINENO, a=$a,b=$b,c=$c&#8221;'</span> DEBUG
<span style="color: #eedd82;">a</span>=1
<span style="color: #00ffff;">if</span> [ <span style="color: #ffa07a;">"$a"</span> -eq 1 ]
<span style="color: #00ffff;">then</span>
    <span style="color: #eedd82;">b</span>=2
<span style="color: #00ffff;">else</span>
    <span style="color: #eedd82;">b</span>=1
<span style="color: #00ffff;">fi</span>
<span style="color: #eedd82;">c</span>=3
<span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"end"</span>
</pre>
</div>
</div>
</li></ul>
</div>

<div id="outline-container-sec-6-3" class="outline-3">
<h3 id="sec-6-3">tee command</h3>
<div class="outline-text-3" id="text-6-3">
<p>
tee命令会从标准输入读取数据，将其内容输出到标准输出设备,同时又可将内容保存成文件。
</p>

<p>
运行这个脚本，实际输出的却不是本机的ip地址，而是广播地址,这时我们可以借助tee命令，输出某些中间结果，将上述脚本片段修改为： 
</p>
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #eedd82;">ipaddr</span>=<span style="color: #fa8072;">`/sbin/ifconfig | grep 'inet addr:' | grep -v '127.0.0.1'</span>
<span style="color: #fa8072;">| tee temp.txt | cut -d : -f3 | awk '{print $1}'`</span>
<span style="color: #b0c4de;">echo</span> $<span style="color: #eedd82;">ipaddr</span>
</pre>
</div>

<p>
之后，将这段脚本再执行一遍，然后查看temp.txt文件的内容： 
</p>
<div class="org-src-container">

<pre class="src src-sh">$ cat temp.txt
inet addr:192.168.0.1  Bcast:192.168.0.255  Mask:255.255.255.0
</pre>
</div>
</div>
</div>





<div id="outline-container-sec-6-4" class="outline-3">
<h3 id="sec-6-4">use debug hook</h3>
<div class="outline-text-3" id="text-6-4">
<p>
使用DEBUG宏来控制是否要输出调试信息，在shell脚本中我们同样可以使用这样的机制，如下列代码所示： 
</p>
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #00ffff;">if</span> [ &#8220;$<span style="color: #eedd82;">DEBUG</span>&#8221; = &#8220;true&#8221; ]; <span style="color: #00ffff;">then</span>
<span style="color: #b0c4de;">echo</span> &#8220;debugging&#8221;  <span style="color: #ff7f24;">#</span><span style="color: #ff7f24;">&#27492;&#22788;&#21487;&#20197;&#36755;&#20986;&#35843;&#35797;&#20449;&#24687;</span>
<span style="color: #00ffff;">fi</span>
</pre>
</div>

<div class="org-src-container">

<pre class="src src-sh"><span style="color: #87cefa;">DEBUG</span>()
{
    <span style="color: #00ffff;">if</span> [ <span style="color: #ffa07a;">"$DEBUG"</span> = <span style="color: #ffa07a;">"true"</span> ]; <span style="color: #00ffff;">then</span>
        $<span style="color: #eedd82;">@</span>&#12288;&#12288;
    <span style="color: #00ffff;">fi</span>
}
<span style="color: #eedd82;">a</span>=1
DEBUG echo <span style="color: #ffa07a;">"a=$a"</span>
</pre>
</div>
</div>
</div>


<div id="outline-container-sec-6-5" class="outline-3">
<h3 id="sec-6-5">command</h3>
<div class="outline-text-3" id="text-6-5">
<p>
-n 只读取shell脚本，但不实际执行
-x 进入跟踪方式，显示所执行的每一条命令
-c "string" 从strings中读取命令 <code>{sh -c 'a=1;b=2;let c=$a+$b;echo "c=$c"'}</code>
</p>
</div>
<ul class="org-ul"><li><a id="sec-6-5-1" name="sec-6-5-1"></a>对"-x"选项的增强<br  /><div class="outline-text-4" id="text-6-5-1">
<p>
几个shell内置的环境变量： 
</p>

<ul class="org-ul">
<li>$LINENO
代表shell脚本的当前行号，类似于C语言中的内置宏_<sub>LINE</sub>__ 
</li>

<li>$FUNCNAME
函数的名字，类似于C语言中的内置宏_<sub>func</sub>__,但宏_<sub>func</sub>_<sub>只能代表当前所</sub>
在的函数名，而$FUNCNAME的功能更强大，它是一个数组变量，其中包含了整个调用链上所有的函数的名字，故变量${FUNCNAME<sup><a id="fnr.1" name="fnr.1" class="footref" href="#fn.1">1</a></sup>}代表shell脚本当前正在执行的函数的名字，而变量${FUNCNAME<sup><a id="fnr.2" name="fnr.2" class="footref" href="#fn.2">2</a></sup>}则代表调用函数${FUNCNAME<sup><a id="fnr.1.100" name="fnr.1.100" class="footref" href="#fn.1">1</a></sup>}
的函数的名字，余者可以依此类推。 
</li>

<li>$PS4
$PS4的值将被显示在“-x”选项输出的每一条命令的前面
</li>
</ul>

<div class="org-src-container">

<pre class="src src-sh">$ export <span style="color: #eedd82;">PS4</span>=<span style="color: #ffa07a;">'+{$LINENO:${FUNCNAME[0]}} '</span>
</pre>
</div>
</div>
</li></ul>
</div>
</div>




<div id="outline-container-sec-7" class="outline-2">
<h2 id="sec-7">Parameter expansion</h2>
<div class="outline-text-2" id="text-7">
</div><div id="outline-container-sec-7-1" class="outline-3">
<h3 id="sec-7-1">Simple usage</h3>
<div class="outline-text-3" id="text-7-1">
<div class="org-src-container">

<pre class="src src-sh">$<span style="color: #eedd82;">PARAMETER</span>
${<span style="color: #eedd82;">PARAMETER</span>}
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-7-2" class="outline-3">
<h3 id="sec-7-2">Indirection</h3>
<div class="outline-text-3" id="text-7-2">
<p>
<code>${PARAMETER}</code>
The referenced parameter is not PARAMETER itself, but the parameter
whose name is stored as the value of PARAMETER. If the parameter
PARAMETER has the value "TEMP", then <code>${!PARAMETER}</code> will expand to the
value of the parameter named TEMP
</p>
</div>
</div>
<div id="outline-container-sec-7-3" class="outline-3">
<h3 id="sec-7-3">Case modification</h3>
<div class="outline-text-3" id="text-7-3">
<div class="org-src-container">

<pre class="src src-sh">${<span style="color: #eedd82;">PARAMETER</span>^} <span style="color: #ff7f24;">#</span><span style="color: #ff7f24;">modifies the first character to uppercase,</span>
${<span style="color: #eedd82;">PARAMETER</span>^^} <span style="color: #ff7f24;"># </span><span style="color: #ff7f24;">all characters are converted</span>
${<span style="color: #eedd82;">PARAMETER</span>,} <span style="color: #ff7f24;">#  </span><span style="color: #ff7f24;">, operator to lowercase</span>
${<span style="color: #eedd82;">PARAMETER</span>,,}
${<span style="color: #eedd82;">PARAMETER</span>~} <span style="color: #ff7f24;">#</span><span style="color: #ff7f24;">~ reverses the case of first letter of words in the variabl</span>
${<span style="color: #eedd82;">PARAMETER</span>~~}
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-7-4" class="outline-3">
<h3 id="sec-7-4">Variable name expansion</h3>
<div class="outline-text-3" id="text-7-4">
<div class="org-src-container">

<pre class="src src-sh">${<span style="color: #eedd82;">!</span>PREFIX*} <span style="color: #ff7f24;">#</span><span style="color: #ff7f24;">This expands to a list of all set variable names beginning with the string PREFIX. </span>
${<span style="color: #eedd82;">!</span>PREFIX@}
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-7-5" class="outline-3">
<h3 id="sec-7-5">Substring removal</h3>
<div class="outline-text-3" id="text-7-5">
<div class="org-src-container">

<pre class="src src-sh">${<span style="color: #eedd82;">PARAMETER</span>#PATTERN}  <span style="color: #ff7f24;">#</span><span style="color: #ff7f24;">The operator "#" will try to remove the shortest text matching the pattern, while "##" tries to do it with the longest text matching. </span>
${<span style="color: #eedd82;">PARAMETER</span>##PATTERN}
${<span style="color: #eedd82;">PARAMETER</span>%PATTERN} <span style="color: #ff7f24;">#</span><span style="color: #ff7f24;">except that Bash now tries to match the pattern from the end of the string</span>
${<span style="color: #eedd82;">PARAMETER</span>%%PATTERN}
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-7-6" class="outline-3">
<h3 id="sec-7-6">Search and replace</h3>
<div class="outline-text-3" id="text-7-6">
<div class="org-src-container">

<pre class="src src-sh">${<span style="color: #eedd82;">PARAMETER</span>/PATTERN/STRING}
${<span style="color: #eedd82;">PARAMETER</span>//PATTERN/STRING}
${<span style="color: #eedd82;">PARAMETER</span>/PATTERN} <span style="color: #ff7f24;">#</span><span style="color: #ff7f24;">removed</span>
${<span style="color: #eedd82;">PARAMETER</span>//PATTERN}

Anchoring Additionally you can <span style="color: #ffa07a;">"anchor"</span> an expression: A <span style="color: #ff7f24;"># </span><span style="color: #ff7f24;">(hashmark) will indicate that your expression is matched against the beginning portion of the string, a % (percent-sign) will do it for the end portion.</span>

<span style="color: #eedd82;">MYSTRING</span>=xxxxxxxxxx
<span style="color: #b0c4de;">echo</span> ${<span style="color: #eedd82;">MYSTRING</span>/#x/y}  <span style="color: #ff7f24;"># </span><span style="color: #ff7f24;">RESULT: yxxxxxxxxx</span>
<span style="color: #b0c4de;">echo</span> ${<span style="color: #eedd82;">MYSTRING</span>/%x/y}  <span style="color: #ff7f24;"># </span><span style="color: #ff7f24;">RESULT: xxxxxxxxxy</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-7-7" class="outline-3">
<h3 id="sec-7-7">String length</h3>
<div class="outline-text-3" id="text-7-7">
<div class="org-src-container">

<pre class="src src-sh">${#<span style="color: #eedd82;">PARAMETER</span>}
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-7-8" class="outline-3">
<h3 id="sec-7-8">Substring expansion</h3>
<div class="outline-text-3" id="text-7-8">
<div class="org-src-container">

<pre class="src src-sh">${<span style="color: #eedd82;">PARAMETER</span>:OFFSET}
${<span style="color: #eedd82;">PARAMETER</span>:OFFSET:LENGTH}
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-7-9" class="outline-3">
<h3 id="sec-7-9">Use a default value</h3>
<div class="outline-text-3" id="text-7-9">
<p>
If the parameter PARAMETER is unset (never was defined) or null
(empty), this one expands to WORD, otherwise it expands to the value
of PARAMETER, as if it just was ${PARAMETER}. If you omit the :
(colon), like shown in the second form, the default value is only used
when the parameter was unset, not when it was empty.
</p>

<div class="org-src-container">

<pre class="src src-sh">${<span style="color: #eedd82;">PARAMETER</span>:-WORD}

${<span style="color: #eedd82;">PARAMETER</span>-WORD}
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-7-10" class="outline-3">
<h3 id="sec-7-10">Assign a default value</h3>
<div class="outline-text-3" id="text-7-10">
<p>
This one works like the using default values, but the default text you
give is not only expanded, but also assigned to the parameter, if it
was unset or null. Equivalent to using a default value, when you omit
the : (colon), as shown in the second form, the default value will
only be assigned when the parameter was unset.
</p>

<div class="org-src-container">

<pre class="src src-sh">${<span style="color: #eedd82;">PARAMETER</span>:=WORD}

${<span style="color: #eedd82;">PARAMETER</span>=WORD}
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-7-11" class="outline-3">
<h3 id="sec-7-11">Use an alternate value</h3>
<div class="outline-text-3" id="text-7-11">
<p>
This form expands to nothing if the parameter is unset or empty. If it
is set, it does not expand to the parameter's value, but to some text
you can specify:
</p>

<div class="org-src-container">

<pre class="src src-sh">${<span style="color: #eedd82;">PARAMETER</span>:+WORD}

${<span style="color: #eedd82;">PARAMETER</span>+WORD}
<span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"The Java application was installed and can be started.${JAVAPATH:+ NOTE: JAVAPATH seems to be set}"</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-7-12" class="outline-3">
<h3 id="sec-7-12">Display error if null or unset</h3>
<div class="outline-text-3" id="text-7-12">
<p>
If the parameter PARAMETER is set/non-null, this form will simply
expand it. Otherwise, the expansion of WORD will be used as appendix
for an error message:
</p>

<ul class="org-ul">
<li>an interactive shell has $? to a non-zero value
</li>
<li>a non-interactive shell exits with a non-zero exit code
</li>
</ul>
<div class="org-src-container">

<pre class="src src-sh">${<span style="color: #eedd82;">PARAMETER</span>:?WORD}

${<span style="color: #eedd82;">PARAMETER</span>?WORD}
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-7-13" class="outline-3">
<h3 id="sec-7-13">Arithmetic and command expansion</h3>
<div class="outline-text-3" id="text-7-13">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #ff7f24;">#</span><span style="color: #ff7f24;">Arithmetic expansion</span>
$(( EXPRESSION ))
$[ EXPRESSION ]  <span style="color: #ff7f24;">#</span><span style="color: #ff7f24;">Please do not use the second form $[ &#8230; ]! It's deprecated. </span>
<span style="color: #ff7f24;">#</span><span style="color: #ff7f24;">Command substitution</span>
$( COMMAND )
<span style="color: #fa8072;">` COMMAND `</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-7-14" class="outline-3">
<h3 id="sec-7-14">Brace expansion</h3>
<div class="outline-text-3" id="text-7-14">
<div class="org-src-container">

<pre class="src src-sh">{string1,string2,...,stringN}
{&lt;START&gt;..&lt;END&gt;}
&lt;PREAMBLE&gt;{........}
{........}&lt;POSTSCRIPT&gt;
&lt;PREAMBLE&gt;{........}&lt;POSTSCRIPT&gt;
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-7-15" class="outline-3">
<h3 id="sec-7-15">aa</h3>
<div class="outline-text-3" id="text-7-15">
<div class="org-src-container">

<pre class="src src-sh"></pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-8" class="outline-2">
<h2 id="sec-8">String Operators</h2>
</div>
<div id="outline-container-sec-9" class="outline-2">
<h2 id="sec-9">Command</h2>
<div class="outline-text-2" id="text-9">
<p>
!$
!$是一个特殊的环境变量，它代表了上一个命令的最后一个字符串。如：你可能会这样：
$mkdir mydir
$mv mydir yourdir
$cd yourdir
可以改成：
$mkdir mydir
\(mv !\) yourdir
\(cd !\)
sudo !!
以root的身份执行上一条命令 。场景举例：比如Ubuntu里用apt-get安装软件包的时候是需要root身份的，我们经常会忘记在apt-get前加sudo。每次不得不加上sudo再重新键入这行命令，这时可以很方便的用sudo !!完事。（陈皓注：在shell下，有时候你会输入很长的命令，你可以使用!xxx来重复最近的一次命令，比如，你以前输入过，vi /where/the/file/is, 下次你可以使用 !vi 重得上次最近一次的vi命令。）
cd –回到上一次的目录 。场景举例：当前目录为/home/a，用cd ../b切换到/home/b。这时可以通过反复执行cd –命令在/home/a和/home/b之间来回方便的切换。（陈皓注：cd ~ 是回到自己的Home目录，cd ~user，是进入某个用户的Home目录）‘ALT+.’ or ‘&lt;ESC&gt; .’热建alt+. 或 esc+. 可以把上次命令行的参数给重复出来。
^old<sup>new</sup>
替换前一条命令里的部分字符串。场景：echo "wanderful"，其实是想输出echo "wonderful"。只需要<sup>a</sup><sup>o就行了，对很长的命令的错误拼写有很大的帮助。（陈皓注：也可以使用</sup> !!:gs/old/new）
du -s * | sort -n | tail
列出当前目录里最大的10个文件。
:w !sudo tee %
在vi中保存一个只有root可以写的文件
date -d@1234567890
时间截转时间
&gt; file.txt
创建一个空文件，比touch短。
mtr coolshell.cn
mtr命令比traceroute要好。在命令行前加空格，该命令不会进入history里。
echo “ls -l” | at midnight
在某个时间运行某个命令。
curl -u user:pass -d status=”Tweeting from the shell” <a href="http://twitter.com/statuses/update.xml">http://twitter.com/statuses/update.xml</a>
命令行的方式更新twitter。
curl -u username –silent “<a href="https://mail.google.com/mail/feed/atom">https://mail.google.com/mail/feed/atom</a>” | perl -ne ‘print “\t” if <i>&lt;name&gt;</i>; print “$2\n” if <i>&lt;(title|name)&gt;(.*)&lt;\</i>\1&gt;/;’检查你的gmail未读邮件
ps aux | sort -nk +4 | tail
列出头十个最耗内存的进程
man ascii
显示ascii码表。场景：忘记ascii码表的时候还需要google么?尤其在天朝网络如此“顺畅”的情况下，就更麻烦在GWF多应用一次规则了，直接用本地的man ascii吧。
ctrl-x e
快速启动你的默认编辑器（由变量$EDITOR设置）。
netstat –tlnp
列出本机进程监听的端口号。（陈皓注：netstat -anop 可以显示侦听在这个端口号的进程）
tail -f <i>path/to/file.log | sed '/<sup>Finished</sup>: SUCCESS$</i> q'
当file.log里出现Finished: SUCCESS时候就退出tail，这个命令用于实时监控并过滤log是否出现了某条记录。
ssh user@server bash &lt; /path/to/local/script.sh
在远程机器上运行一段脚本。这条命令最大的好处就是不用把脚本拷到远程机器上。
ssh user@host cat /path/to/remotefile | diff /path/to/localfile -
比较一个远程文件和一个本地文件
net rpc shutdown -I ipAddressOfWindowsPC -U username%password
远程关闭一台Windows的机器
screen -d -m -S some<sub>name</sub> ping my<sub>router</sub>
后台运行一段不终止的程序，并可以随时查看它的状态。-d -m参数启动“分离”模式，-S指定了一个session的标识。可以通过-R命令来重新“挂载”一个标识的session。更多细节请参考screen用法 man screen。
wget &#x2013;random-wait -r -p -e robots=off -U mozilla <a href="http://www.example.com">http://www.example.com</a>
下载整个www.example.com网站。（注：别太过分，大部分网站都有防爬功能了：））
curl ifconfig.me
当你的机器在内网的时候，可以通过这个命令查看外网的IP。
convert input.png -gravity NorthWest -background transparent -extent 720×200  output.png
改一下图片的大小尺寸
lsof –i
实时查看本机网络服务的活动状态。
vim scp://username@host//path/to/somefile
vim一个远程文件
python -m SimpleHTTPServer
一句话实现一个HTTP服务，把当前目录设为HTTP服务目录，可以通过<a href="http://localhost:8000%E8%AE%BF%E9%97%AE">http://localhost:8000%E8%AE%BF%E9%97%AE</a> 这也许是这个星球上最简单的HTTP服务器的实现了。
history | awk '{CMD[$2]++;count++;} END { for (a in CMD )print CMD[a] " " CMD[a]/count*100 "% " a }' | grep -v "./" | column -c3 -s " " -t | sort -nr | nl | head -n10
(陈皓注：有点复杂了，history|awk ‘{print $2}’|awk ‘BEGIN {FS=”|”} {print $1}’|sort|uniq -c|sort -rn|head -10)
这行脚本能输出你最常用的十条命令，由此甚至可以洞察你是一个什么类型的程序员。
</p>
</div>
</div>

<div id="outline-container-sec-10" class="outline-2">
<h2 id="sec-10">getopts</h2>
<div class="outline-text-2" id="text-10">
<p>
Note that getopts is not able to parse GNU-style long options
(&#x2013;myoption) or XF86-style long options (-myoption)!
</p>

<ul class="org-ul">
<li>OPTIND       Holds the index to the next argument to be processed. This is
how getopts "remembers" its own status between invocations. Also
usefull to shift the positional parameters after processing with
getopts. OPTIND is initially set to 1, and needs to be re-set to 1
if you want to parse anything again with getopts
</li>
<li>OPTARG        This variable is set to any argument for an option
found by getopts. It also contains the option flag of an unknown
option.
</li>
<li>OPTERR        (Values 0 or 1) Indicates if Bash should display error
messages generated by the getopts builtin. The value is initialized
to 1 on every shell startup - so be sure to always set it to 0 if
you don't want to see annoying messages!
</li>
</ul>


<div class="org-src-container">

<pre class="src src-sh"><span style="color: #ff7f24;">#</span><span style="color: #ff7f24;">The base-syntax for getopts is:</span>
<span style="color: #b0c4de;">getopts</span> OPTSTRING VARNAME [ARGS...]

OPTSTRING tells getopts which options to expect and where to expect arguments (see below)
VARNAME tells getopts which shell-variable to use for option reporting
ARGS    tells getopts to parse these optional words instead of the positional parameters
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-11" class="outline-2">
<h2 id="sec-11">compute float number</h2>
<div class="outline-text-2" id="text-11">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #eedd82;">result</span>=$(<span style="color: #b0c4de;">echo</span> 1 23 | awk <span style="color: #ffa07a;">'{printf("%.2f", ($1/$2)*100)}'</span>)
=&gt;<span style="color: #eedd82;">result</span>=4.35

<span style="color: #eedd82;">a</span>=12.34
<span style="color: #eedd82;">b</span>=23.45
<span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"$a*$b"</span>|bc

<span style="color: #eedd82;">a</span>=12.34
<span style="color: #eedd82;">b</span>=23.45
<span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"scale=1;$a/$b"</span>|bc <span style="color: #ff7f24;">#</span><span style="color: #ff7f24;">&#20445;&#30041;&#23567;&#25968;&#28857;&#31934;&#24230;&#21482;&#23545;&#38500;&#27861;&#26377;&#25928;</span>
.5
<span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"scale=2;$a/$b"</span>|bc
.52
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-12" class="outline-2">
<h2 id="sec-12">positional parameters</h2>
<div class="outline-text-2" id="text-12">
<div class="org-src-container">

<pre class="src src-sh">$<span style="color: #eedd82;">FUNCNAME</span>        the <span style="color: #00ffff;">function</span> <span style="color: #87cefa;">name</span> (attention: inside a <span style="color: #00ffff;">function</span>, $<span style="color: #eedd82;">0</span> is still the $<span style="color: #eedd82;">0</span> of the shell, not the <span style="color: #00ffff;">function</span> <span style="color: #87cefa;">name</span>)
$<span style="color: #eedd82;">1</span> &#8230; $<span style="color: #eedd82;">9</span>        the argument list elements from 1 to 9
${<span style="color: #eedd82;">10</span>} &#8230; ${<span style="color: #eedd82;">N</span>}   the argument list elements beyond 9 (note the parameter expansion syntax!)
$<span style="color: #eedd82;">*</span>      all positional parameters except $<span style="color: #eedd82;">0</span>
$<span style="color: #eedd82;">@</span>      all positional parameters except $<span style="color: #eedd82;">0</span>
$<span style="color: #eedd82;">#</span>      the number of arguments, not counting $<span style="color: #eedd82;">0</span>
</pre>
</div>
</div>
<div id="outline-container-sec-12-1" class="outline-3">
<h3 id="sec-12-1">loop through the positional parameters</h3>
<div class="outline-text-3" id="text-12-1">
<div class="org-src-container">

<pre class="src src-sh"><span style="color: #eedd82;">numargs</span>=$<span style="color: #eedd82;">#</span>
<span style="color: #00ffff;">for</span> ((<span style="color: #eedd82;">i</span>=1 ; i &lt;= numargs ; i++))
<span style="color: #00ffff;">do</span>
    <span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"$1"</span>
    <span style="color: #b0c4de;">shift</span>
<span style="color: #00ffff;">done</span>
<span style="color: #ff7f24;">#</span><span style="color: #ff7f24;">or</span>
<span style="color: #00ffff;">for</span> arg
<span style="color: #00ffff;">do</span>
    <span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"$arg"</span>
<span style="color: #00ffff;">done</span>
<span style="color: #ff7f24;">#</span><span style="color: #ff7f24;">while but it has the disadvantage to stop when $1 is empty (null-string)</span>
<span style="color: #00ffff;">while</span> [ <span style="color: #ffa07a;">"$1"</span> ]
<span style="color: #00ffff;">do</span>
    <span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"$1"</span>
    <span style="color: #b0c4de;">shift</span>
<span style="color: #00ffff;">done</span>
<span style="color: #ff7f24;"># </span><span style="color: #ff7f24;">run as long as $1 is defined</span>
<span style="color: #00ffff;">while</span> [ <span style="color: #ffa07a;">"${1+defined}"</span> ]; <span style="color: #00ffff;">do</span>
  <span style="color: #b0c4de;">echo</span> <span style="color: #ffa07a;">"$1"</span>
  <span style="color: #b0c4de;">shift</span>
<span style="color: #00ffff;">done</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-12-2" class="outline-3">
<h3 id="sec-12-2">mass usage</h3>
<div class="outline-text-3" id="text-12-2">
<div class="org-src-container">

<pre class="src src-sh">$<span style="color: #eedd82;">*</span>      $<span style="color: #eedd82;">1</span> $<span style="color: #eedd82;">2</span> $<span style="color: #eedd82;">3</span> &#8230; ${<span style="color: #eedd82;">N</span>}
$<span style="color: #eedd82;">@</span>      $<span style="color: #eedd82;">1</span> $<span style="color: #eedd82;">2</span> $<span style="color: #eedd82;">3</span> &#8230; ${<span style="color: #eedd82;">N</span>}
<span style="color: #ffa07a;">"$*"</span>    <span style="color: #ffa07a;">"$1c$2c$3c&#8230;c${N}"</span> <span style="color: #ff7f24;"># </span><span style="color: #ff7f24;">where 'c' is the first character of IFS.</span>
<span style="color: #ffa07a;">"$@"</span>    <span style="color: #ffa07a;">"$1"</span> <span style="color: #ffa07a;">"$2"</span> <span style="color: #ffa07a;">"$3"</span> &#8230; <span style="color: #ffa07a;">"${N}"</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-12-3" class="outline-3">
<h3 id="sec-12-3">Range Of Positional Parameters</h3>
<div class="outline-text-3" id="text-12-3">
<div class="org-src-container">

<pre class="src src-sh">${<span style="color: #eedd82;">@</span>:START:COUNT}
${<span style="color: #eedd82;">*</span>:START:COUNT}
<span style="color: #ffa07a;">"${@:START:COUNT}"</span>
<span style="color: #ffa07a;">"${*:START:COUNT}"</span>
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-13" class="outline-2">
<h2 id="sec-13">多个文件总大小</h2>
<div class="outline-text-2" id="text-13">
<div class="org-src-container">

<pre class="src src-sh">cat filelist | xargs du -cb
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-14" class="outline-2">
<h2 id="sec-14">regular expression</h2>
<div class="outline-text-2" id="text-14">
<div class="org-src-container">

<pre class="src src-sh">&#21305;&#37197;&#20013;&#25991;&#23383;&#31526;&#30340;&#27491;&#21017;&#34920;&#36798;&#24335;&#65306;[u4e00-u9fa5]
&#35780;&#27880;&#65306;&#21305;&#37197;&#20013;&#25991;&#36824;&#30495;&#26159;&#20010;&#22836;&#30140;&#30340;&#20107;&#65292;&#26377;&#20102;&#36825;&#20010;&#34920;&#36798;&#24335;&#23601;&#22909;&#21150;&#20102;

<span style="color: #87cefa;">&#21305;&#37197;&#21452;&#23383;&#33410;&#23383;&#31526;</span>(&#21253;&#25324;&#27721;&#23383;&#22312;&#20869;)&#65306;[^x00-xff]
&#35780;&#27880;&#65306;&#21487;&#20197;&#29992;&#26469;&#35745;&#31639;&#23383;&#31526;&#20018;&#30340;&#38271;&#24230;&#65288;&#19968;&#20010;&#21452;&#23383;&#33410;&#23383;&#31526;&#38271;&#24230;&#35745;2&#65292;ASCII&#23383;&#31526;&#35745;1&#65289;

&#21305;&#37197;&#31354;&#30333;&#34892;&#30340;&#27491;&#21017;&#34920;&#36798;&#24335;&#65306;ns*r
&#35780;&#27880;&#65306;&#21487;&#20197;&#29992;&#26469;&#21024;&#38500;&#31354;&#30333;&#34892;

&#21305;&#37197;HTML&#26631;&#35760;&#30340;&#27491;&#21017;&#34920;&#36798;&#24335;&#65306;&lt;(S*?)[^&gt;]*&gt;.*?&lt;/1&gt;|&lt;.*? /&gt;
&#35780;&#27880;&#65306;&#32593;&#19978;&#27969;&#20256;&#30340;&#29256;&#26412;&#22826;&#31967;&#31957;&#65292;&#19978;&#38754;&#36825;&#20010;&#20063;&#20165;&#20165;&#33021;&#21305;&#37197;&#37096;&#20998;&#65292;&#23545;&#20110;&#22797;&#26434;&#30340;&#23884;&#22871;&#26631;&#35760;&#20381;&#26087;&#26080;&#33021;&#20026;&#21147;

&#21305;&#37197;&#39318;&#23614;&#31354;&#30333;&#23383;&#31526;&#30340;&#27491;&#21017;&#34920;&#36798;&#24335;&#65306;^s*|s*$
&#35780;&#27880;&#65306;&#21487;&#20197;&#29992;&#26469;&#21024;&#38500;&#34892;&#39318;&#34892;&#23614;&#30340;&#31354;&#30333;&#23383;&#31526;(&#21253;&#25324;&#31354;&#26684;&#12289;&#21046;&#34920;&#31526;&#12289;&#25442;&#39029;&#31526;&#31561;&#31561;)&#65292;&#38750;&#24120;&#26377;&#29992;&#30340;&#34920;&#36798;&#24335;

&#21305;&#37197;Email&#22320;&#22336;&#30340;&#27491;&#21017;&#34920;&#36798;&#24335;&#65306;w+([-+.]w+)*@w+([-.]w+)*.w+([-.]w+)*
&#35780;&#27880;&#65306;&#34920;&#21333;&#39564;&#35777;&#26102;&#24456;&#23454;&#29992;

&#21305;&#37197;&#32593;&#22336;URL&#30340;&#27491;&#21017;&#34920;&#36798;&#24335;&#65306;[a-zA-z]+://[^s]*
&#35780;&#27880;&#65306;&#32593;&#19978;&#27969;&#20256;&#30340;&#29256;&#26412;&#21151;&#33021;&#24456;&#26377;&#38480;&#65292;&#19978;&#38754;&#36825;&#20010;&#22522;&#26412;&#21487;&#20197;&#28385;&#36275;&#38656;&#27714;

<span style="color: #87cefa;">&#21305;&#37197;&#24080;&#21495;&#26159;&#21542;&#21512;&#27861;</span>(&#23383;&#27597;&#24320;&#22836;&#65292;&#20801;&#35768;5-16&#23383;&#33410;&#65292;&#20801;&#35768;&#23383;&#27597;&#25968;&#23383;&#19979;&#21010;&#32447;)&#65306;^[a-zA-Z][a-zA-Z0-9_]{4,15}$
&#35780;&#27880;&#65306;&#34920;&#21333;&#39564;&#35777;&#26102;&#24456;&#23454;&#29992;

&#21305;&#37197;&#22269;&#20869;&#30005;&#35805;&#21495;&#30721;&#65306;d{3}-d{8}|d{4}-d{7}
&#35780;&#27880;&#65306;&#21305;&#37197;&#24418;&#24335;&#22914;0511-4405222&#25110;021-87888822

&#21305;&#37197;&#33150;&#35759;QQ&#21495;&#65306;[1-9][0-9]{4,}
&#35780;&#27880;&#65306;&#33150;&#35759;QQ&#21495;&#20174;10000&#24320;&#22987;

&#21305;&#37197;&#20013;&#22269;&#37038;&#25919;&#32534;&#30721;&#65306;[1-9]d{5}(?!d)
&#35780;&#27880;&#65306;&#20013;&#22269;&#37038;&#25919;&#32534;&#30721;&#20026;6&#20301;&#25968;&#23383;

&#21305;&#37197;&#36523;&#20221;&#35777;&#65306;d{15}|d{18}
&#35780;&#27880;&#65306;&#20013;&#22269;&#30340;&#36523;&#20221;&#35777;&#20026;15&#20301;&#25110;18&#20301;

&#21305;&#37197;ip&#22320;&#22336;&#65306;d+.d+.d+.d+

&#35780;&#27880;&#65306;&#25552;&#21462;ip&#22320;&#22336;&#26102;&#26377;&#29992;

&#21305;&#37197;&#29305;&#23450;&#25968;&#23383;&#65306;
^[1-9]d*$&#12288;&#12288;//&#21305;&#37197;&#27491;&#25972;&#25968;
^-[1-9]d*$&#12288;//&#21305;&#37197;&#36127;&#25972;&#25968;
^-?[1-9]d*$&#12288;&#12288;//&#21305;&#37197;&#25972;&#25968;
^[1-9]d*|0$&#12288;//&#21305;&#37197;&#38750;&#36127;&#25972;&#25968;&#65288;&#27491;&#25972;&#25968;+ 0&#65289;
^-[1-9]d*|0$&#12288;&#12288;//&#21305;&#37197;&#38750;&#27491;&#25972;&#25968;&#65288;&#36127;&#25972;&#25968;+ 0&#65289;
^[1-9]d*.d*|0.d*[1-9]d*$&#12288;&#12288;//&#21305;&#37197;&#27491;&#28014;&#28857;&#25968;
^-([1-9]d*.d*|0.d*[1-9]d*)$&#12288;//&#21305;&#37197;&#36127;&#28014;&#28857;&#25968;
^-?([1-9]d*.d*|0.d*[1-9]d*|0?.0+|0)$&#12288;//&#21305;&#37197;&#28014;&#28857;&#25968;
^[1-9]d*.d*|0.d*[1-9]d*|0?.0+|0$&#12288;&#12288;//&#21305;&#37197;&#38750;&#36127;&#28014;&#28857;&#25968;&#65288;&#27491;&#28014;&#28857;&#25968;+ 0&#65289;
^(-([1-9]d*.d*|0.d*[1-9]d*))|0?.0+|0$&#12288;&#12288;//&#21305;&#37197;&#38750;&#27491;&#28014;&#28857;&#25968;&#65288;&#36127;&#28014;&#28857;&#25968;+ 0&#65289;
&#35780;&#27880;&#65306;&#22788;&#29702;&#22823;&#37327;&#25968;&#25454;&#26102;&#26377;&#29992;&#65292;&#20855;&#20307;&#24212;&#29992;&#26102;&#27880;&#24847;&#20462;&#27491;

&#21305;&#37197;&#29305;&#23450;&#23383;&#31526;&#20018;&#65306;
^[A-Za-z]+$&#12288;&#12288;//&#21305;&#37197;&#30001;26&#20010;&#33521;&#25991;&#23383;&#27597;&#32452;&#25104;&#30340;&#23383;&#31526;&#20018;
^[A-Z]+$&#12288;&#12288;//&#21305;&#37197;&#30001;26&#20010;&#33521;&#25991;&#23383;&#27597;&#30340;&#22823;&#20889;&#32452;&#25104;&#30340;&#23383;&#31526;&#20018;
^[a-z]+$&#12288;&#12288;//&#21305;&#37197;&#30001;26&#20010;&#33521;&#25991;&#23383;&#27597;&#30340;&#23567;&#20889;&#32452;&#25104;&#30340;&#23383;&#31526;&#20018;
^[A-Za-z0-9]+$&#12288;&#12288;//&#21305;&#37197;&#30001;&#25968;&#23383;&#21644;26&#20010;&#33521;&#25991;&#23383;&#27597;&#32452;&#25104;&#30340;&#23383;&#31526;&#20018;
^w+$&#12288;&#12288;//&#21305;&#37197;&#30001;&#25968;&#23383;&#12289;26&#20010;&#33521;&#25991;&#23383;&#27597;&#25110;&#32773;&#19979;&#21010;&#32447;&#32452;&#25104;&#30340;&#23383;&#31526;&#20018;
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-15" class="outline-2">
<h2 id="sec-15">touch</h2>
<div class="outline-text-2" id="text-15">
</div><div id="outline-container-sec-15-1" class="outline-3">
<h3 id="sec-15-1">touch all folders in a directory</h3>
<div class="outline-text-3" id="text-15-1">
<div class="org-src-container">

<pre class="src src-sh">find . -maxdepth 1 -mindepth 1 -type d -exec touch {} <span style="color: #ffa07a;">\+</span>
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-15-2" class="outline-3">
<h3 id="sec-15-2">touch all files in a directory</h3>
<div class="outline-text-3" id="text-15-2">
<div class="org-src-container">

<pre class="src src-sh">find * -exec touch {} <span style="color: #ffa07a;">\;</span>
<span style="color: #ff7f24;"># </span><span style="color: #ff7f24;">set time to 29th of Feb 2012.</span>
find * -exec touch -t 201202291000 {} <span style="color: #ffa07a;">\;</span>
</pre>
</div>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" name="fn.1" class="footnum" href="#fnr.1">1</a></sup> <p>DEFINITION NOT FOUND.</p></div>

<div class="footdef"><sup><a id="fn.2" name="fn.2" class="footnum" href="#fnr.2">2</a></sup> <p>DEFINITION NOT FOUND.</p></div>


</div>
</div></div>
<div id="postamble" class="status">
<p class="author">Author: Shi Shougang</p>
<p class="date">Created: 2015-03-07 Sat 15:38</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 24.3.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
