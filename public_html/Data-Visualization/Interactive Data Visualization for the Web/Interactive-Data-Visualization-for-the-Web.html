<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Interactive Data Visualization for the Web</title>
<!-- 2015-04-27 Mon 23:16 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Shi Shougang" />
<link rel="stylesheet" href="./assets/stylesheet.css" type="text/css"/>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Interactive Data Visualization for the Web</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">Preface</a></li>
<li><a href="#sec-2">Introduction</a>
<ul>
<li><a href="#sec-2-1">Why Interactive?</a></li>
</ul>
</li>
<li><a href="#sec-3">Introducing D3</a>
<ul>
<li><a href="#sec-3-1">What It Doesn’t Do</a></li>
<li><a href="#sec-3-2">Origins and Context</a></li>
<li><a href="#sec-3-3">Alternatives</a></li>
</ul>
</li>
<li><a href="#sec-4">Technology Fundamentals</a>
<ul>
<li><a href="#sec-4-1">A Note on Compatibility</a></li>
</ul>
</li>
<li><a href="#sec-5">Setup</a>
<ul>
<li><a href="#sec-5-1">Setting Up a Web Server</a></li>
</ul>
</li>
<li><a href="#sec-6">Data</a>
<ul>
<li><a href="#sec-6-1">Binding Data</a></li>
</ul>
</li>
<li><a href="#sec-7">Drawing with Data</a>
<ul>
<li><a href="#sec-7-1">Multivalue Maps</a></li>
</ul>
</li>
<li><a href="#sec-8">Scales</a>
<ul>
<li><a href="#sec-8-1">Setting Up Dynamic Scales</a></li>
<li><a href="#sec-8-2">Incorporating Scaled Values</a></li>
<li><a href="#sec-8-3">Other Methods</a></li>
<li><a href="#sec-8-4">Other Scales</a></li>
</ul>
</li>
<li><a href="#sec-9">Axes</a>
<ul>
<li><a href="#sec-9-1">Setting Up an Axis</a></li>
<li><a href="#sec-9-2">Cleaning It Up</a></li>
<li><a href="#sec-9-3">Check for Ticks</a></li>
<li><a href="#sec-9-4">Formatting Tick Labels</a></li>
</ul>
</li>
<li><a href="#sec-10">Updates, Transitions, and Motion</a>
<ul>
<li><a href="#sec-10-1">Modernizing the Bar Chart</a></li>
<li><a href="#sec-10-2">Transitions</a></li>
<li><a href="#sec-10-3">Other Kinds of Data Updates</a></li>
</ul>
</li>
<li><a href="#sec-11">Interactivity</a>
<ul>
<li><a href="#sec-11-1">Introducing Behaviors</a></li>
</ul>
</li>
<li><a href="#sec-12">Layouts</a>
<ul>
<li><a href="#sec-12-1">Pie Layout</a></li>
<li><a href="#sec-12-2">Stack Layout</a></li>
<li><a href="#sec-12-3">Force Layout</a></li>
</ul>
</li>
<li><a href="#sec-13">Geomapping</a>
<ul>
<li><a href="#sec-13-1">JSON, Meet GeoJSON</a></li>
<li><a href="#sec-13-2">Paths</a></li>
<li><a href="#sec-13-3">Projections</a></li>
<li><a href="#sec-13-4">Choropleth</a></li>
</ul>
</li>
<li><a href="#sec-14">More reference</a></li>
</ul>
</div>
</div>
<p>
nm#+SETUPFILE: ~/.emacs.d/src/org-templates/level-2.org
</p>


<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Preface</h2>
<div class="outline-text-2" id="text-1">
<p>
On design process:
</p>

<ul class="org-ul">
<li>Designing Data Visualizations: Intentional Communication from Data
to Display by Noah Iliinsky and Julie Steele. O’Reilly Media, 2011.
</li>
<li>Data Visualization: A Successful Design Process by Andy Kirk. Packt
Publishing, 2012.
</li>
<li>The Functional Art: An Introduction to Information Graphics and
Visualization by Alberto Cairo. New Riders, 2012
</li>
<li>Information Dashboard Design: The Effective Visual Communication of
Data by Stephen Few. O’Reilly Media, 2006.
</li>
</ul>

<p>
On the practicalities of working with data:
</p>
<ul class="org-ul">
<li>Bad Data Handbook: Mapping the World of Data Problems by Q. Ethan
McCallum. O’Reilly Media, 2012
</li>
<li>Data Analysis with Open Source Tools: A Hands-On Guide for
Programmers and Data Scientists by Philipp K. Janert. O’Reilly
Media, 2010.
</li>
<li>Python for Data Analysis: Agile Tools for Real World Data by Wes
McKinney.O’Reilly Media, 2012.
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">Introduction</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">Why Interactive?</h3>
<div class="outline-text-3" id="text-2-1">
<p>
The basic functions of most interactive visualization tools have
changed little since 1996, when Ben Shneiderman of the University of
Maryland first proposed a “Visual Information-Seeking Mantra”:
<i>overview first, zoom and filter, then details-ondemand</i>.
</p>
</div>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">Introducing D3</h2>
<div class="outline-text-2" id="text-3">
<p>
D3’s official home on the Web is d3js.org.
</p>
</div>
<div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1">What It Doesn’t Do</h3>
<div class="outline-text-3" id="text-3-1">
<ul class="org-ul">
<li>D3 is intended primarily for  explanatoryvisualization work, as
opposed to exploratory  visualizations.
</li>
<li>D3 doesn’t even try to support older browsers.
</li>
<li>D3’s core functionality doesn’t handle bitmap map tiles, such as
those provided by Google Maps or Cloudmade. D3 is great with
anything vector—SVG images or GeoJSON data—but wasn’t originally
intended to work with traditional map tiles.
</li>
<li>D3 doesn’t hide your original data.
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2">Origins and Context</h3>
<div class="outline-text-3" id="text-3-2">
<p>
Protovis made generating visualizations simple, even for users without
prior programming experience. Yet to achieve this, it created an
abstract representation layer. The designer could address this layer
using Protovis syntax, but it wasn’t accessible through standard
methods, so debugging was difficult.
</p>

<p>
In 2011, Mike Bostock, Vadim Ogievetsky, and Jeff Heer officially
announced D3, the next evolution in web visualization tools. Unlike
Protovis, D3 operates directly on the web document itself. This means
easier debugging, easier experimentation, and more visual
possibilities. The only downside to this approach is a potentially
steeper learning curve.
</p>
</div>
</div>

<div id="outline-container-sec-3-3" class="outline-3">
<h3 id="sec-3-3">Alternatives</h3>
<div class="outline-text-3" id="text-3-3">
</div><ul class="org-ul"><li><a id="sec-3-3-1" name="sec-3-3-1"></a>Easy Charts<br  /><div class="outline-text-4" id="text-3-3-1">
<ul class="org-ul">
<li>DataWrapper: A beautiful web service that lets you upload your data
and quickly generate a chart that you can republish elsewhere or
embed on your site. This service was originally intended for
journalists, but it is helpful for everyone. 
</li>
<li>Flot; A plotting library for jQuery that uses the HTML canvas
element and supports older browsers, even all the way back to
Internet Explorer 6. It supports limited visual forms (lines,
points, bars, areas), but it is easy to use.
</li>
<li>Google Chart Tools: Having evolved from their earlier Image Charts
API, Google’s Chart Tools can be used to generate several standard
chart types, with support for old versions of IE.
</li>
<li>gRaphaël: It has more visual flexibility than Flot, and—some might
say—it is prettier.
</li>
<li>Highcharts JS: A JavaScript-based charting library with several
predesigned themes and chart types. It uses SVG for modern browsers
and falls back on VMLfor old versions of IE, including IE6 and
later.
</li>
<li>JavaScript InfoVis Toolkit: The JIT provides several preset
visualization styles for your data. It includes lots of examples,
but the documentation is pretty technical. The toolkit is great if
you like one of the preset styles, but browser support is unclear.
</li>
<li>jqPlot: A plug-in for charting with jQuery. This supports very
simple charts and is great if you are okay with the predefined
styles.
</li>
<li>jQuery Sparklines: A jQuery plug-in for generating sparklines,
typically small bar, line, or area charts used inline with text.
</li>
<li>Peity: A jQuery plug-in for very simple and very  tinybar, line, and
pie charts that supports only recent browsers.
</li>
<li>Timeline.js: A library specifically for generating interactive
timelines. No coding is required; just use the code generator. There
is not much room for customization, but hey, timelines are really
hard to do well.
</li>
<li>YUI Charts: The Charts module for the Y ahoo! User Interface Library
enables creation of simple charts with a goal of wide browser
support.
</li>
</ul>
</div>
</li>

<li><a id="sec-3-3-2" name="sec-3-3-2"></a>Graph Visualizations<br  /><div class="outline-text-4" id="text-3-3-2">
<ul class="org-ul">
<li>Arbor.js: A library for graph visualization using jQuery. Even if
you never use this, you should check out how the documentation is
presented as a graph, using the tool itself. 
</li>
<li>Sigma.js: A very lightweight library for graph visualization.
Sigma.js is beautiful and fast, and it also uses canvas.
</li>
</ul>
</div>
</li>
<li><a id="sec-3-3-3" name="sec-3-3-3"></a>Geomapping<br  /><div class="outline-text-4" id="text-3-3-3">
<ul class="org-ul">
<li>Kartograph: A JavaScript-and-Python combo for gorgeous, entirely
vector-based mapping by Gregor Aisch with must-see demos. Kartograph
works with IE7 and newer.
</li>
<li>Leaflet: A library for tiled maps, designed for smooth interaction
on both desktop and mobile devices.
</li>
<li>Modest Maps: The granddaddy of tiled map libraries, Modest Maps has
been succeeded by Polymaps, but lots of people still love it, as
it is lightweight and works with old versions of IE and other
browsers. Modest Maps has been adapted for ActionScript, Processing,
Python, PHP, Cinder, openFrameworks…yeah, basically everything.
</li>
<li>Polymaps: A library for displaying tiled maps, with layers of data
on top of the tiles.
</li>
</ul>
</div>
</li>
<li><a id="sec-3-3-4" name="sec-3-3-4"></a>Almost from Scratch<br  /><div class="outline-text-4" id="text-3-3-4">
<ul class="org-ul">
<li>Processing.js: A native JavaScript implementation of Processing, the
fantastic programming language for artists and designers new to
programming. Processing is written in Java, so exporting Processing
sketches to the Web traditionally involved clunky Java applets.
Thanks to Processing.js, regular Processing code can run natively,
in the browser.
</li>
<li>Paper.js: A framework for rendering vector graphics to canvas.
</li>
<li>Raphaël: Another library for drawing vector graphics, popular due to
its friendly syntax and support for older browsers.
</li>
</ul>
</div>
</li>
<li><a id="sec-3-3-5" name="sec-3-3-5"></a>Three-Dimensional<br  /><div class="outline-text-4" id="text-3-3-5">
<ul class="org-ul">
<li>PhiloGL: A WebGL framework specifically for 3D visualization.
</li>
<li>Three.js: A library for generating any sort of 3D scene you could
imagine, produced by Google’s Data Arts team. 
</li>
</ul>
</div>
</li>
<li><a id="sec-3-3-6" name="sec-3-3-6"></a>Tools Built with D3<br  /><div class="outline-text-4" id="text-3-3-6">
<ul class="org-ul">
<li>Crossfilter: A library for working with large, multivariate
datasets, written primarily by Mike Bostock. This is useful for
trying to squeeze your “big data” into a relatively small web
browser.
</li>
<li>Cubism: A D3 plug-in for visualizing time series data.
</li>
<li>Dashku: An online tool for data dashboards and widgets updated in
real time
</li>
<li>dc.js: The “dc” is short for dimensional charting, as this library
is optimized for exploring large, multidimensional datasets.
</li>
<li>NVD3: Reusable charts with D3. NVD3 offers lots of beautiful
examples, w visual customizations without requiring as much code as
D3 alone.
</li>
<li>Polychart.js: More reusable charts, with a range of chart types
available. Polychart.js is free only for noncommercial use.
</li>
<li>Rickshaw: A toolkit for displaying time series data that is also
very customizable.
</li>
<li>Tributary: A great tool for experimenting with live coding using D3.
</li>
</ul>
</div>
</li></ul>
</div>
</div>

<div id="outline-container-sec-4" class="outline-2">
<h2 id="sec-4">Technology Fundamentals</h2>
<div class="outline-text-2" id="text-4">
</div><div id="outline-container-sec-4-1" class="outline-3">
<h3 id="sec-4-1">A Note on Compatibility</h3>
<div class="outline-text-3" id="text-4-1">
<p>
Older browsers don’t support SVG. So, generally speaking, Internet
Explorer version 8 and older will not display SVG images at all. 
</p>

<p>
That said, it’s polite to notify users of older browsers why the
piece isn’t working. I recommend using <b>Modernizr</b> or a similar
JavaScript tool to detect whether or not the browser supports SVG. If
it does, then you can load your D3 code and proceed as normal. If SVG
is  notsupported, then you can display a static, noninteractive
version of your visualization alongside a message explaining that a
current browser is needed. (Be nice and provide links to the Chrome and
Firefox  download pages.)
</p>

<p>
I’d typically have something like this in the &lt;head&gt;of my document:
</p>

<div class="org-src-container">

<pre class="src src-javascript">&lt;script src=<span style="color: #ffa07a;">"js/modernizr.js"</span>&gt;&lt;/script&gt;
&lt;script type=<span style="color: #ffa07a;">"text/javascript"</span>&gt;
    Modernizr.load({
        test: Modernizr.svg &amp;&amp; Modernizr.inlinesvg,
        yep : [ <span style="color: #ffa07a;">'js/d3.v3.min.js'</span>,
                <span style="color: #ffa07a;">'js/script.js'</span> ]
    });
&lt;/script&gt;
</pre>
</div>

<p>
caniuse.comis a fantastic resource for supported browser features. See
their list of browsers with SVG support.
</p>
</div>
</div>
</div>
<div id="outline-container-sec-5" class="outline-2">
<h2 id="sec-5">Setup</h2>
<div class="outline-text-2" id="text-5">
</div><div id="outline-container-sec-5-1" class="outline-3">
<h3 id="sec-5-1">Setting Up a Web Server</h3>
<div class="outline-text-3" id="text-5-1">
<div class="org-src-container">

<pre class="src src-sh">python -m SimpleHTTPServer 8888 &amp;.
</pre>
</div>

<p>
use <code>http://localhost:8888/.</code>
</p>
</div>
</div>
</div>
<div id="outline-container-sec-6" class="outline-2">
<h2 id="sec-6">Data</h2>
<div class="outline-text-2" id="text-6">
</div><div id="outline-container-sec-6-1" class="outline-3">
<h3 id="sec-6-1">Binding Data</h3>
<div class="outline-text-3" id="text-6-1">
</div><ul class="org-ul"><li><a id="sec-6-1-1" name="sec-6-1-1"></a>Loading CSV data<br  /><div class="outline-text-4" id="text-6-1-1">
<div class="org-src-container">

<pre class="src src-javascript"><span style="color: #00ffff;">var</span> <span style="color: #eedd82;">dataset</span>;
d3.csv(<span style="color: #ffa07a;">"food.csv"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">error</span>, <span style="color: #eedd82;">data</span>) {
    <span style="color: #00ffff;">if</span> (error) {  <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">If error is not null, something went wrong.</span>
        console.log(error);  <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Log the error.</span>
    } <span style="color: #00ffff;">else</span> {  <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">If no error, the file loaded correctly. Yay!</span>
        console.log(data);  <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Log the data.</span>
        <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Include other code to execute after successful file load here</span>
        dataset = data;
        generateVis();
        hideLoadingMsg();
    }
});
</pre>
</div>

<p>
One more tip: if you have tab-separated data in a TSV file, try the
<code>d3.tsv()</code>  method.
</p>
</div>
</li>
<li><a id="sec-6-1-2" name="sec-6-1-2"></a>Loading JSON data<br  /><div class="outline-text-4" id="text-6-1-2">
<div class="org-src-container">

<pre class="src src-javascript">d3.json(<span style="color: #ffa07a;">"waterfallVelocities.json"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">json</span>) {
    console.log(json);  <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Log output to console</span>
});
</pre>
</div>
</div>
</li></ul>
</div>
</div>
<div id="outline-container-sec-7" class="outline-2">
<h2 id="sec-7">Drawing with Data</h2>
<div class="outline-text-2" id="text-7">
<p>
<code>attr()</code> sets DOM attribute values, whereas  <code>style()</code> applies CSS
styles directly to an element.
</p>
</div>
<div id="outline-container-sec-7-1" class="outline-3">
<h3 id="sec-7-1">Multivalue Maps</h3>
<div class="outline-text-3" id="text-7-1">
<div class="org-src-container">

<pre class="src src-javascript">  svg.select(<span style="color: #ffa07a;">"circle"</span>)
      .attr(<span style="color: #ffa07a;">"cx"</span>, 0)
      .attr(<span style="color: #ffa07a;">"cy"</span>, 0)
      .attr(<span style="color: #ffa07a;">"fill"</span>, <span style="color: #ffa07a;">"red"</span>);

  svg.select(<span style="color: #ffa07a;">"circle"</span>)
      .attr({
          cx: 0,
          cy: 0,
          fill: red
      });

svg.selectAll(<span style="color: #ffa07a;">"rect"</span>)
    .data(dataset)
    .enter()
    .append(<span style="color: #ffa07a;">"rect"</span>)
    .attr({
        <span style="color: #87cefa;">x</span>: <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>, <span style="color: #eedd82;">i</span>) { <span style="color: #00ffff;">return</span> i * (w / dataset.length); },
        <span style="color: #87cefa;">y</span>: <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) { <span style="color: #00ffff;">return</span> h - (d * 4); },
        width: w / dataset.length - barPadding,
        <span style="color: #87cefa;">height</span>: <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) { <span style="color: #00ffff;">return</span> d * 4; },
        <span style="color: #87cefa;">fill</span>: <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) { <span style="color: #00ffff;">return</span> <span style="color: #ffa07a;">"rgb(0, 0, "</span> + (d * 10) + <span style="color: #ffa07a;">")"</span>; }
    });
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-8" class="outline-2">
<h2 id="sec-8">Scales</h2>
<div class="outline-text-2" id="text-8">
<div class="org-src-container">

<pre class="src src-javascript"><span style="color: #00ffff;">var</span> <span style="color: #eedd82;">scale</span> = d3.scale.linear()
    .domain([100, 500])
    .range([10, 350]);
</pre>
</div>

<p>
<code>d3.min() and d3.max()</code>
</p>

<div class="org-src-container">

<pre class="src src-javascript">d3.max(dataset, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) {
    <span style="color: #00ffff;">return</span> d[0];
});
</pre>
</div>
</div>
<div id="outline-container-sec-8-1" class="outline-3">
<h3 id="sec-8-1">Setting Up Dynamic Scales</h3>
<div class="outline-text-3" id="text-8-1">
<div class="org-src-container">

<pre class="src src-javascript"><span style="color: #00ffff;">var</span> <span style="color: #eedd82;">xScale</span> = d3.scale.linear()
    .domain([0, d3.max(dataset, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) { <span style="color: #00ffff;">return</span> d[0]; })])
    .range([0, w]);
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-8-2" class="outline-3">
<h3 id="sec-8-2">Incorporating Scaled Values</h3>
<div class="outline-text-3" id="text-8-2">
<div class="org-src-container">

<pre class="src src-javascript">.attr(<span style="color: #ffa07a;">"x"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) {
<span style="color: #00ffff;">return</span> xScale(d[0]);
})
.attr(<span style="color: #ffa07a;">"y"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) {
    <span style="color: #00ffff;">return</span> yScale(d[1]);
})
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-8-3" class="outline-3">
<h3 id="sec-8-3">Other Methods</h3>
<div class="outline-text-3" id="text-8-3">
<ul class="org-ul">
<li>nice()
</li>
<li>rangeRound()
</li>
<li>clamp(): Calling clamp(true)on a scale, however, forces all output
values to be within the specified range. This means excessive values
will be rounded to the range’s low or high value (whichever is
nearest).
</li>
</ul>
</div>
</div>
<div id="outline-container-sec-8-4" class="outline-3">
<h3 id="sec-8-4">Other Scales</h3>
<div class="outline-text-3" id="text-8-4">
<ul class="org-ul">
<li>sqrt
</li>
<li>pow
</li>
<li>log
</li>
<li>quantize
</li>
<li>quantile
</li>
<li>ordinal
</li>
<li>d3.scale.category10(), d3.scale.category20(),
d3.scale.category20b(), and d3.scale.category20c()
</li>
<li>d3.time.scale()
</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-sec-9" class="outline-2">
<h2 id="sec-9">Axes</h2>
<div class="outline-text-2" id="text-9">
</div><div id="outline-container-sec-9-1" class="outline-3">
<h3 id="sec-9-1">Setting Up an Axis</h3>
<div class="outline-text-3" id="text-9-1">
<div class="org-src-container">

<pre class="src src-javascript">  <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">xScale</span> = d3.scale.linear()
      .domain([0, d3.max(dataset, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) { <span style="color: #00ffff;">return</span> d[0]; })])
      .range([padding, w - padding * 2]);
  <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Create SVG element</span>
<span style="color: #00ffff;">var</span> <span style="color: #eedd82;">svg</span> = d3.select(<span style="color: #ffa07a;">"body"</span>)
    .append(<span style="color: #ffa07a;">"svg"</span>)
    .attr(<span style="color: #ffa07a;">"width"</span>, w)
    .attr(<span style="color: #ffa07a;">"height"</span>, h);

svg.append(<span style="color: #ffa07a;">"g"</span>)
    .call(xAxis);
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-9-2" class="outline-3">
<h3 id="sec-9-2">Cleaning It Up</h3>
<div class="outline-text-3" id="text-9-2">
<div class="org-src-container">

<pre class="src src-javascript">  &lt;style type=<span style="color: #ffa07a;">"text/css"</span>&gt;
      .axis path,
      .axis line {
          fill: none;
          stroke: black;
          shape-rendering: crispEdges;
      }

      .axis text {
          font-family: sans-serif;
          font-size: 11px;
      }
  &lt;/style&gt;
&lt;script type=<span style="color: #ffa07a;">"text/javascript"</span>&gt;
<span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Create scale functions</span>
    <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">xScale</span> = d3.scale.linear()
    .domain([0, d3.max(dataset, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) { <span style="color: #00ffff;">return</span> d[0]; })])
    .range([padding, w - padding * 2]);
<span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Create SVG element</span>
<span style="color: #00ffff;">var</span> <span style="color: #eedd82;">svg</span> = d3.select(<span style="color: #ffa07a;">"body"</span>)
    .append(<span style="color: #ffa07a;">"svg"</span>)
    .attr(<span style="color: #ffa07a;">"width"</span>, w)
    .attr(<span style="color: #ffa07a;">"height"</span>, h);
<span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Create X axis</span>
svg.append(<span style="color: #ffa07a;">"g"</span>)
    .attr(<span style="color: #ffa07a;">"class"</span>, <span style="color: #ffa07a;">"axis"</span>)
    .attr(<span style="color: #ffa07a;">"transform"</span>, <span style="color: #ffa07a;">"translate(0,"</span> + (h - padding) + <span style="color: #ffa07a;">")"</span>)
    .call(xAxis);
&lt;/script&gt;
</pre>
</div>

<p>
review your  property namesvery closely to ensure you’re using SVG
names, not CSS ones. (You can reference the complete SVG attribute
list on the MDN site.)
</p>
</div>
</div>
<div id="outline-container-sec-9-3" class="outline-3">
<h3 id="sec-9-3">Check for Ticks</h3>
<div class="outline-text-3" id="text-9-3">
<div class="org-src-container">

<pre class="src src-javascript"><span style="color: #00ffff;">var</span> <span style="color: #eedd82;">xAxis</span> = d3.svg.axis()
    .scale(xScale)
    .orient(<span style="color: #ffa07a;">"bottom"</span>)
    .ticks(5);  <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Set rough # of tick</span>
</pre>
</div>

<p>
D3 inteprets the <code>ticks()</code> value as merely a suggestion and will override
your suggestion with what it determines to be the most clean and
human-readable values
</p>
</div>
</div>
<div id="outline-container-sec-9-4" class="outline-3">
<h3 id="sec-9-4">Formatting Tick Labels</h3>
<div class="outline-text-3" id="text-9-4">
<div class="org-src-container">

<pre class="src src-javascript"><span style="color: #00ffff;">var</span> <span style="color: #eedd82;">formatAsPercentage</span> = d3.format(<span style="color: #ffa07a;">".1%"</span>);
xAxis.tickFormat(formatAsPercentage);
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-10" class="outline-2">
<h2 id="sec-10">Updates, Transitions, and Motion</h2>
<div class="outline-text-2" id="text-10">
</div><div id="outline-container-sec-10-1" class="outline-3">
<h3 id="sec-10-1">Modernizing the Bar Chart</h3>
<div class="outline-text-3" id="text-10-1">
<div class="org-src-container">

<pre class="src src-javascript">  <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">xScale</span> = d3.scale.ordinal()
      .domain(d3.range(dataset.length))
      .rangeRoundBands([0, w], 0.05);
<span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Create bars</span>
svg.selectAll(<span style="color: #ffa07a;">"rect"</span>)
    .data(dataset)
    .enter()
    .append(<span style="color: #ffa07a;">"rect"</span>)
    .attr(<span style="color: #ffa07a;">"x"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>, <span style="color: #eedd82;">i</span>) {
        <span style="color: #00ffff;">return</span> xScale(i);
    })
    .attr(<span style="color: #ffa07a;">"width"</span>, xScale.rangeBand())
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-10-2" class="outline-3">
<h3 id="sec-10-2">Transitions</h3>
<div class="outline-text-3" id="text-10-2">
<p>
Making a nice, super smooth, animated transition is as simple as
adding one line of code:
</p>

<div class="org-src-container">

<pre class="src src-javascript">.transition()
</pre>
</div>

<p>
ease() must also be specified after transition(), but before the
attr() statements to which the transition applies. 
</p>
<div class="org-src-container">

<pre class="src src-javascript">&#8230;  <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Selection statement(s)</span>
.transition()
.duration(2000)
.ease(<span style="color: #ffa07a;">"linear"</span>)
&#8230;  <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">attr() statements</span>
</pre>
</div>

<p>
cubic-in-outis the default.
</p>
</div>
<ul class="org-ul"><li><a id="sec-10-2-1" name="sec-10-2-1"></a>each() Transition Starts and Ends<br  /><div class="outline-text-4" id="text-10-2-1">
<div class="org-src-container">

<pre class="src src-javascript"><span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Update all circles</span>
svg.selectAll(<span style="color: #ffa07a;">"circle"</span>)
    .data(dataset)
    .transition()
    .duration(1000)
    .each(<span style="color: #ffa07a;">"start"</span>, <span style="color: #00ffff;">function</span>() {  <span style="color: #ff7f24;">// </span><span style="color: #ff7f24;">&lt;-- Executes at start of transition</span>
        d3.select(<span style="color: #7fffd4;">this</span>)
            .attr(<span style="color: #ffa07a;">"fill"</span>, <span style="color: #ffa07a;">"magenta"</span>)
            .attr(<span style="color: #ffa07a;">"r"</span>, 3);
    })
        .attr(<span style="color: #ffa07a;">"cx"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) {
            <span style="color: #00ffff;">return</span> xScale(d[0]);
        })
    .attr(<span style="color: #ffa07a;">"cy"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) {
        <span style="color: #00ffff;">return</span> yScale(d[1]);
    })
    .each(<span style="color: #ffa07a;">"end"</span>, <span style="color: #00ffff;">function</span>() {  <span style="color: #ff7f24;">// </span><span style="color: #ff7f24;">&lt;-- Executes at end of transition</span>
        d3.select(<span style="color: #7fffd4;">this</span>)
            .attr(<span style="color: #ffa07a;">"fill"</span>, <span style="color: #ffa07a;">"black"</span>)
            .attr(<span style="color: #ffa07a;">"r"</span>, 2);
    });
</pre>
</div>
</div>
</li></ul>
</div>
<div id="outline-container-sec-10-3" class="outline-3">
<h3 id="sec-10-3">Other Kinds of Data Updates</h3>
<div class="outline-text-3" id="text-10-3">
</div><ul class="org-ul"><li><a id="sec-10-3-1" name="sec-10-3-1"></a>Adding Values<br  /><div class="outline-text-4" id="text-10-3-1">
<p>
we can use <code>enter()</code> to address the one new corresponding DOM element,
without touching all the existing rects.
</p>

<div class="org-src-container">

<pre class="src src-javascript">dataset.push(newNumber);
<span style="color: #00ffff;">var</span> <span style="color: #eedd82;">bars</span> = svg.selectAll(<span style="color: #ffa07a;">"rect"</span>)                        <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Select all bars</span>
    .data(dataset); <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Re-bind data to existing bars, return the 'update' selection</span>
bars.enter()                                                <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">References the enter selection (a subset of the update selection)</span>
    .append(<span style="color: #ffa07a;">"rect"</span>)         <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Creates a new rect</span>
    .attr(<span style="color: #ffa07a;">"x"</span>, w)                       <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Sets the initial x position of the rect beyond the far right edge of the SVG</span>
    .attr(<span style="color: #ffa07a;">"y"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) {               <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Sets the y value, based on the updated yScale</span>
        <span style="color: #00ffff;">return</span> h - yScale(d);
    })
    .attr(<span style="color: #ffa07a;">"width"</span>, xScale.rangeBand())    <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Sets the width value, based on the updated xScale</span>
    .attr(<span style="color: #ffa07a;">"height"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) {          <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Sets the height value, based on the updated yScale</span>
        <span style="color: #00ffff;">return</span> yScale(d);
    })
    .attr(<span style="color: #ffa07a;">"fill"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) {        <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Sets the fill value</span>
        <span style="color: #00ffff;">return</span> <span style="color: #ffa07a;">"rgb(0, 0, "</span> + (d * 10) + <span style="color: #ffa07a;">")"</span>;
    });
</pre>
</div>
</div>
</li>
<li><a id="sec-10-3-2" name="sec-10-3-2"></a>Removing Values<br  /><div class="outline-text-4" id="text-10-3-2">
<div class="org-src-container">

<pre class="src src-javascript"><span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Remove one value from dataset</span>
dataset.shift();

bars.exit()                             <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">References the exit selection (a subset of the update selection)</span>
    .transition()           <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Initiates a transition on the one element we're deleting</span>
    .duration(500)
    .attr(<span style="color: #ffa07a;">"x"</span>, w)           <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Move past the right edge of the SVG</span>
    .remove();              <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Deletes this element from the DOM once transition is complete</span>
</pre>
</div>
</div>
</li>
<li><a id="sec-10-3-3" name="sec-10-3-3"></a>Add and Remove<br  /><div class="outline-text-4" id="text-10-3-3">
<div class="org-src-container">

<pre class="src src-javascript"><span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">See which p was clicked</span>
<span style="color: #00ffff;">var</span> <span style="color: #eedd82;">paragraphID</span> = d3.select(<span style="color: #7fffd4;">this</span>).attr(<span style="color: #ffa07a;">"id"</span>);
<span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Decide what to do next</span>
<span style="color: #00ffff;">if</span> (paragraphID == <span style="color: #ffa07a;">"add"</span>) {
    <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Add a data value</span>
    <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">maxValue</span> = 25;
    <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">newNumber</span> = Math.floor(Math.random() * maxValue);
    <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">lastKeyValue</span> = dataset[dataset.length - 1].key;
    console.log(lastKeyValue);
    dataset.push({
        key: lastKeyValue + 1,
        value: newNumber
    });
} <span style="color: #00ffff;">else</span> {
    <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Remove a value</span>
    dataset.shift();
}
</pre>
</div>
</div>
</li></ul>
</div>
</div>
<div id="outline-container-sec-11" class="outline-2">
<h2 id="sec-11">Interactivity</h2>
<div class="outline-text-2" id="text-11">
<p>
Making your visualization interactive is a simple, two-step process
that includes:
</p>
<ol class="org-ol">
<li>Binding event listeners
</li>
<li>Defining the behavior
</li>
</ol>
</div>
<div id="outline-container-sec-11-1" class="outline-3">
<h3 id="sec-11-1">Introducing Behaviors</h3>
<div class="outline-text-3" id="text-11-1">
</div><ul class="org-ul"><li><a id="sec-11-1-1" name="sec-11-1-1"></a>Hover to Highlight<br  /><div class="outline-text-4" id="text-11-1-1">
<ul class="org-ul">
<li>mouseover
</li>
</ul>

<div class="org-src-container">

<pre class="src src-javascript">.on(<span style="color: #ffa07a;">"mouseover"</span>, <span style="color: #00ffff;">function</span>() {
    d3.select(<span style="color: #7fffd4;">this</span>)
        .attr(<span style="color: #ffa07a;">"fill"</span>, <span style="color: #ffa07a;">"orange"</span>);
});
</pre>
</div>
<ul class="org-ul">
<li>mouseout
</li>
</ul>
<div class="org-src-container">

<pre class="src src-javascript">.on(<span style="color: #ffa07a;">"mouseout"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) {
    d3.select(<span style="color: #7fffd4;">this</span>)
        .attr(<span style="color: #ffa07a;">"fill"</span>, <span style="color: #ffa07a;">"rgb(0, 0, "</span> + (d * 10) + <span style="color: #ffa07a;">")"</span>);
});
</pre>
</div>

<p>
Mouse events are triggered only on elements with pixels that can be
“touched” by the mouse. If two elements overlap, and the mouse moves
over the element that is “on top” (in other words, closer to the
front), then the mouseover event will be triggered on the frontmost
element, and noton the element behind it.
</p>
</div>
</li></ul>
</div>
</div>

<div id="outline-container-sec-12" class="outline-2">
<h2 id="sec-12">Layouts</h2>
<div class="outline-text-2" id="text-12">
</div><div id="outline-container-sec-12-1" class="outline-3">
<h3 id="sec-12-1">Pie Layout</h3>
<div class="outline-text-3" id="text-12-1">
<div class="org-src-container">

<pre class="src src-javascript"><span style="color: #00ffff;">var</span> <span style="color: #eedd82;">w</span> = 300;
<span style="color: #00ffff;">var</span> <span style="color: #eedd82;">h</span> = 300;

<span style="color: #00ffff;">var</span> <span style="color: #eedd82;">dataset</span> = [ 5, 10, 20, 45, 6, 25 ];

<span style="color: #00ffff;">var</span> <span style="color: #eedd82;">outerRadius</span> = w / 2;
<span style="color: #00ffff;">var</span> <span style="color: #eedd82;">innerRadius</span> = 0;
<span style="color: #00ffff;">var</span> <span style="color: #eedd82;">arc</span> = d3.svg.arc()
    .innerRadius(innerRadius)
    .outerRadius(outerRadius);
<span style="color: #00ffff;">var</span> <span style="color: #eedd82;">pie</span> = d3.layout.pie();

<span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Easy colors accessible via a 10-step ordinal scale</span>
<span style="color: #00ffff;">var</span> <span style="color: #eedd82;">color</span> = d3.scale.category10();

<span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Create SVG element</span>
<span style="color: #00ffff;">var</span> <span style="color: #eedd82;">svg</span> = d3.select(<span style="color: #ffa07a;">"body"</span>)
    .append(<span style="color: #ffa07a;">"svg"</span>)
    .attr(<span style="color: #ffa07a;">"width"</span>, w)
    .attr(<span style="color: #ffa07a;">"height"</span>, h);

<span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Set up groups</span>
<span style="color: #00ffff;">var</span> <span style="color: #eedd82;">arcs</span> = svg.selectAll(<span style="color: #ffa07a;">"g.arc"</span>)
    .data(pie(dataset))
    .enter()
    .append(<span style="color: #ffa07a;">"g"</span>)
    .attr(<span style="color: #ffa07a;">"class"</span>, <span style="color: #ffa07a;">"arc"</span>)
    .attr(<span style="color: #ffa07a;">"transform"</span>, <span style="color: #ffa07a;">"translate("</span> + outerRadius + <span style="color: #ffa07a;">","</span> + outerRadius + <span style="color: #ffa07a;">")"</span>);

<span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Draw arc paths</span>
arcs.append(<span style="color: #ffa07a;">"path"</span>)
    .attr(<span style="color: #ffa07a;">"fill"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>, <span style="color: #eedd82;">i</span>) {
        <span style="color: #00ffff;">return</span> color(i);
    })
    .attr(<span style="color: #ffa07a;">"d"</span>, arc);
</pre>
</div>
</div>
</div>

<div id="outline-container-sec-12-2" class="outline-3">
<h3 id="sec-12-2">Stack Layout</h3>
<div class="outline-text-3" id="text-12-2">
<div class="org-src-container">

<pre class="src src-javascript"><span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Set up stack method</span>
                        <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">stack</span> = d3.layout.stack();

                        <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Data, stacked</span>
                        stack(dataset);

                        <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Set up scales</span>
                        <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">xScale</span> = d3.scale.ordinal()
                                .domain(d3.range(dataset[0].length))
                                .rangeRoundBands([0, w], 0.05);

                        <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">yScale</span> = d3.scale.linear()
                                .domain([0,                             
                                        d3.max(dataset, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) {
                                                <span style="color: #00ffff;">return</span> d3.max(d, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) {
                                                        <span style="color: #00ffff;">return</span> d.y0 + d.y;
                                                });
                                        })
                                ])
                                .range([0, h]);

                        <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Easy colors accessible via a 10-step ordinal scale</span>
                        <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">colors</span> = d3.scale.category10();

                        <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Create SVG element</span>
                        <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">svg</span> = d3.select(<span style="color: #ffa07a;">"body"</span>)
                                                .append(<span style="color: #ffa07a;">"svg"</span>)
                                                .attr(<span style="color: #ffa07a;">"width"</span>, w)
                                                .attr(<span style="color: #ffa07a;">"height"</span>, h);

                        <span style="color: #ff7f24;">// </span><span style="color: #ff7f24;">Add a group for each row of data</span>
                        <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">groups</span> = svg.selectAll(<span style="color: #ffa07a;">"g"</span>)
                                .data(dataset)
                                .enter()
                                .append(<span style="color: #ffa07a;">"g"</span>)
                                .style(<span style="color: #ffa07a;">"fill"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>, <span style="color: #eedd82;">i</span>) {
                                        <span style="color: #00ffff;">return</span> colors(i);
                                });

                        <span style="color: #ff7f24;">// </span><span style="color: #ff7f24;">Add a rect for each data value</span>
                        <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">rects</span> = groups.selectAll(<span style="color: #ffa07a;">"rect"</span>)
                                .data(<span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) { <span style="color: #00ffff;">return</span> d; })
                                .enter()
                                .append(<span style="color: #ffa07a;">"rect"</span>)
                                .attr(<span style="color: #ffa07a;">"x"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>, <span style="color: #eedd82;">i</span>) {
                                        <span style="color: #00ffff;">return</span> xScale(i);
                                })
                                .attr(<span style="color: #ffa07a;">"y"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) {
                                        <span style="color: #00ffff;">return</span> yScale(d.y0);
                                })
                                .attr(<span style="color: #ffa07a;">"height"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) {
                                        <span style="color: #00ffff;">return</span> yScale(d.y);
                                })
                                .attr(<span style="color: #ffa07a;">"width"</span>, xScale.rangeBand());
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-12-3" class="outline-3">
<h3 id="sec-12-3">Force Layout</h3>
<div class="outline-text-3" id="text-12-3">
<div class="org-src-container">

<pre class="src src-javascript"><span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Initialize a default force layout, using the nodes and edges in dataset</span>
                        <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">force</span> = d3.layout.force()
                                                                 .nodes(dataset.nodes)
                                                                 .links(dataset.edges)
                                                                 .size([w, h])
                                                                 .linkDistance([50])
                                                                 .charge([-100])
                                                                 .start();

                        <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">colors</span> = d3.scale.category10();

                        <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Create SVG element</span>
                        <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">svg</span> = d3.select(<span style="color: #ffa07a;">"body"</span>)
                                                .append(<span style="color: #ffa07a;">"svg"</span>)
                                                .attr(<span style="color: #ffa07a;">"width"</span>, w)
                                                .attr(<span style="color: #ffa07a;">"height"</span>, h);

                        <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Create edges as lines</span>
                        <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">edges</span> = svg.selectAll(<span style="color: #ffa07a;">"line"</span>)
                                .data(dataset.edges)
                                .enter()
                                .append(<span style="color: #ffa07a;">"line"</span>)
                                .style(<span style="color: #ffa07a;">"stroke"</span>, <span style="color: #ffa07a;">"#ccc"</span>)
                                .style(<span style="color: #ffa07a;">"stroke-width"</span>, 1);

                        <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Create nodes as circles</span>
                        <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">nodes</span> = svg.selectAll(<span style="color: #ffa07a;">"circle"</span>)
                                .data(dataset.nodes)
                                .enter()
                                .append(<span style="color: #ffa07a;">"circle"</span>)
                                .attr(<span style="color: #ffa07a;">"r"</span>, 10)
                                .style(<span style="color: #ffa07a;">"fill"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>, <span style="color: #eedd82;">i</span>) {
                                        <span style="color: #00ffff;">return</span> colors(i);
                                })
                                .call(force.drag);

                        <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Every time the simulation "ticks", this will be called</span>
                        force.on(<span style="color: #ffa07a;">"tick"</span>, <span style="color: #00ffff;">function</span>() {

                                edges.attr(<span style="color: #ffa07a;">"x1"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) { <span style="color: #00ffff;">return</span> d.source.x; })
                                         .attr(<span style="color: #ffa07a;">"y1"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) { <span style="color: #00ffff;">return</span> d.source.y; })
                                         .attr(<span style="color: #ffa07a;">"x2"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) { <span style="color: #00ffff;">return</span> d.target.x; })
                                         .attr(<span style="color: #ffa07a;">"y2"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) { <span style="color: #00ffff;">return</span> d.target.y; });

                                nodes.attr(<span style="color: #ffa07a;">"cx"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) { <span style="color: #00ffff;">return</span> d.x; })
                                         .attr(<span style="color: #ffa07a;">"cy"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) { <span style="color: #00ffff;">return</span> d.y; });

                        });
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-13" class="outline-2">
<h2 id="sec-13">Geomapping</h2>
<div class="outline-text-2" id="text-13">
</div><div id="outline-container-sec-13-1" class="outline-3">
<h3 id="sec-13-1">JSON, Meet GeoJSON</h3>
<div class="outline-text-3" id="text-13-1">
<p>
<a href="http://teczno.com/squares/#11.64/37.9587/-121.8676">Get Lat+Lon</a> is a great resource by Michal Migurski for doublechecking
coordinate values. 
</p>

<p>
Its core features from Squares. <a href="https://github.com/migurski/Squares">Squares</a> is a small, extensible, free
and open-source library for in-browser maps, written in Typescript and
using D3 v2 under the hood..
</p>
</div>
</div>

<div id="outline-container-sec-13-2" class="outline-3">
<h3 id="sec-13-2">Paths</h3>
<div class="outline-text-3" id="text-13-2">
<div class="org-src-container">

<pre class="src src-javascript"><span style="color: #00ffff;">var</span> <span style="color: #eedd82;">path</span> = d3.geo.path();
<span style="color: #00ffff;">var</span> <span style="color: #eedd82;">svg</span> = d3.select(<span style="color: #ffa07a;">"body"</span>)
    .append(<span style="color: #ffa07a;">"svg"</span>)
    .attr(<span style="color: #ffa07a;">"width"</span>, w)
    .attr(<span style="color: #ffa07a;">"height"</span>, h);

<span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Load in GeoJSON data</span>
d3.json(<span style="color: #ffa07a;">"us-states.json"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">json</span>) {
    <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Bind data and create one path per GeoJSON feature</span>
    svg.selectAll(<span style="color: #ffa07a;">"path"</span>)
        .data(json.features)
        .enter()
        .append(<span style="color: #ffa07a;">"path"</span>)
        .attr(<span style="color: #ffa07a;">"d"</span>, path);
});
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-13-3" class="outline-3">
<h3 id="sec-13-3">Projections</h3>
<div class="outline-text-3" id="text-13-3">
<div class="org-src-container">

<pre class="src src-javascript"><span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Define map projection</span>
<span style="color: #00ffff;">var</span> <span style="color: #eedd82;">projection</span> = d3.geo.albersUsa()
<span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Define path generator</span>
<span style="color: #00ffff;">var</span> <span style="color: #eedd82;">path</span> = d3.geo.path()
                                 .projection(projection);
<span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Create SVG element</span>
<span style="color: #00ffff;">var</span> <span style="color: #eedd82;">svg</span> = d3.select(<span style="color: #ffa07a;">"body"</span>)
                        .append(<span style="color: #ffa07a;">"svg"</span>)
                        .attr(<span style="color: #ffa07a;">"width"</span>, w)
                        .attr(<span style="color: #ffa07a;">"height"</span>, h);
<span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Load in GeoJSON data</span>
d3.json(<span style="color: #ffa07a;">"us-states.json"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">json</span>) {
        <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Bind data and create one path per GeoJSON feature</span>
        svg.selectAll(<span style="color: #ffa07a;">"path"</span>)
           .data(json.features)
           .enter()
           .append(<span style="color: #ffa07a;">"path"</span>)
           .attr(<span style="color: #ffa07a;">"d"</span>, path)
           .style(<span style="color: #ffa07a;">"fill"</span>, <span style="color: #ffa07a;">"steelblue"</span>);

});
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-13-4" class="outline-3">
<h3 id="sec-13-4">Choropleth</h3>
<div class="outline-text-3" id="text-13-4">
<div class="org-src-container">

<pre class="src src-javascript"><span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Define map projection</span>
<span style="color: #00ffff;">var</span> <span style="color: #eedd82;">projection</span> = d3.geo.albersUsa()
    .translate([w/2, h/2])
    .scale([500]);
<span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Define path generator</span>
<span style="color: #00ffff;">var</span> <span style="color: #eedd82;">path</span> = d3.geo.path()
    .projection(projection);
<span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Define quantize scale to sort data values into buckets of color</span>
<span style="color: #00ffff;">var</span> <span style="color: #eedd82;">color</span> = d3.scale.quantize()
    .range([<span style="color: #ffa07a;">"rgb(237,248,233)"</span>,<span style="color: #ffa07a;">"rgb(186,228,179)"</span>,<span style="color: #ffa07a;">"rgb(116,196,118)"</span>,<span style="color: #ffa07a;">"rgb(49,163,84)"</span>,<span style="color: #ffa07a;">"rgb(0,109,44)"</span>]);
<span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Colors taken from colorbrewer.js, included in the D3 download</span>
<span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Create SVG element</span>
<span style="color: #00ffff;">var</span> <span style="color: #eedd82;">svg</span> = d3.select(<span style="color: #ffa07a;">"body"</span>)
    .append(<span style="color: #ffa07a;">"svg"</span>)
    .attr(<span style="color: #ffa07a;">"width"</span>, w)
    .attr(<span style="color: #ffa07a;">"height"</span>, h);
<span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Load in agriculture data</span>
d3.csv(<span style="color: #ffa07a;">"us-ag-productivity-2004.csv"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">data</span>) {
    <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Set input domain for color scale</span>
    color.domain([
        d3.min(data, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) { <span style="color: #00ffff;">return</span> d.value; }), 
        d3.max(data, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) { <span style="color: #00ffff;">return</span> d.value; })
    ]);
    <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Load in GeoJSON data</span>
    d3.json(<span style="color: #ffa07a;">"us-states.json"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">json</span>) {
        <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Merge the ag. data and GeoJSON</span>
        <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Loop through once for each ag. data value</span>
        <span style="color: #00ffff;">for</span> (<span style="color: #00ffff;">var</span> <span style="color: #eedd82;">i</span> = 0; i &lt; data.length; i++) {
            <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Grab state name</span>
            <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">dataState</span> = data[i].state;
            <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Grab data value, and convert from string to float</span>
            <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">dataValue</span> = parseFloat(data[i].value);
            <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Find the corresponding state inside the GeoJSON</span>
            <span style="color: #00ffff;">for</span> (<span style="color: #00ffff;">var</span> <span style="color: #eedd82;">j</span> = 0; j &lt; json.features.length; j++) {
                <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">jsonState</span> = json.features[j].properties.name;
                <span style="color: #00ffff;">if</span> (dataState == jsonState) {
                    <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Copy the data value into the JSON</span>
                    json.features[j].properties.value = dataValue;
                    <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Stop looking through the JSON</span>
                    <span style="color: #00ffff;">break</span>;
                }
            }               
        }
        <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Bind data and create one path per GeoJSON feature</span>
        svg.selectAll(<span style="color: #ffa07a;">"path"</span>)
            .data(json.features)
            .enter()
            .append(<span style="color: #ffa07a;">"path"</span>)
            .attr(<span style="color: #ffa07a;">"d"</span>, path)
            .style(<span style="color: #ffa07a;">"fill"</span>, <span style="color: #00ffff;">function</span>(<span style="color: #eedd82;">d</span>) {
                <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">Get data value</span>
                <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">value</span> = d.properties.value;
                <span style="color: #00ffff;">if</span> (value) {
                    <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">If value exists&#8230;</span>
                    <span style="color: #00ffff;">return</span> color(value);
                } <span style="color: #00ffff;">else</span> {
                    <span style="color: #ff7f24;">//</span><span style="color: #ff7f24;">If value is undefined&#8230;</span>
                    <span style="color: #00ffff;">return</span> <span style="color: #ffa07a;">"#ccc"</span>;
                }
            });

    });
});
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-sec-14" class="outline-2">
<h2 id="sec-14">More reference</h2>
<div class="outline-text-2" id="text-14">
<ul class="org-ul">
<li><a href="http://www.quirksmode.org/blog/archives/2008/04/event_compatibi.html">Peter-Paul Koch’s  event compatibility tables</a>
</li>
<li>Getting Starting with D3by Mike Dewar . O’Reilly, 2012
</li>
<li>github.com/mbostock/d3/wiki/Gallery  The D3 gallery contains
hundredsof examples.
</li>
<li>bl.ocks.org/mbostock    Even more examples, in this case all by Mike
Bostock, each one typically highlighting just one of D3’s features.
</li>
<li>github.com/mbostock/d3/wiki/API-Reference
The D3 API reference, an essential reference for every method and
its parameters.
</li>
<li>groups.google.com/forum/?fromgroups#!forum/d3-js
Everyone who’s anyone is on the D3 Google Group.
</li>
<li>bl.ocks.org
A service for posting code hosted on GitHub’s Gist, by Mike
Bostock.
</li>
<li>blog.visual.ly/creating-animations-and-transitions-with-d3-js/
An excellent tutorial on Creating Animations and Transitions With D3
with lots of inline, interactive examples by Jérôme Cukier.
</li>
<li>d3noob.org
A new, promising resource for D3 tips and tricks.
</li>
<li>tributary.io
 A live-coding environment for experimenting with D3 code, by Ian
Johnson.
</li>
<li>D3 Plug-ins
 A listing of all the official plug-ins that extend D3’s
functionality, in case it doesn’t do enough for you already.
</li>
</ul>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Shi Shougang</p>
<p class="date">Created: 2015-04-27 Mon 23:16</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 24.3.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
